<br>

<table align="center"><tr><td> <br> "You don't have to know everything. You simply need to know where to find it when necessary." --- John Brunner <br> </td></tr></table>

<br>

# Project 1: System Hardening

| **Report Version** | 1.0 |
|:------------------ |:--- |
| **Prepared By**   | Broen Westberg |
| **Date**          | February 27, 2025 |
| **Local Time**    | 11:23 PM MST |

#### **UTC Timestamps of latest file revision:**
```plaintext
2025-02-28T06:23:00Z  # Standard Unix for logging
1709085780000         # Milliseconds since Epoch, for JavaScript & Database scrapers
0x6584A23C            # Hexadecimal Epoch Time, for Forensics and associated Logs
MTcwOTA4NTc4MA==      # Base64 Encoded Epoch, for app inclusion
```

<br>

## OS Information

| **Information**         | **Details**        |
|-------------------------|--------------------|
| **Customer**            | The Baker Street Corporation (BSC) |
| **Hostname**            | `hostname` <br> Baker_Street_Linux_Server |
| **OS Version**          | `cat /etc/os-release` <br> Ubuntu 22.04.5 LTS (Jammy Jellyfish) |
| **Memory Information**  | `free -h` <br><br> `total:      15.4G`<br>`used:       1.3G`<br>`free:       9.8G`<br>`shared:     200M`<br>`buff/cache: 4.3G`<br>`available:  13.6G` |
| **Uptime Information**  | `uptime` <br> 03:46:51 up  2:06,  0 users,  load average: 0.16, 0.22, 0.23 |
| **Public IPv4**         | `curl -4 ifconfig.me; echo` <br> 35.172.233.252 |
| **Local IPv4**          | `hostname -I \| awk '{print $1}'` <br> 10.0.1.205 |

<br>

## Checklist

| Completed Activity                      | Script(s) used / Tasks completed / Screenshots |
|------------------------------------------|-----------------------------------------------|
| **OS backup**                            | `tar -cvpzf /root/baker_street_backup_$(date +%F).tar.gz --exclude=/root/baker_street_backup* --exclude=/proc --exclude=/tmp --exclude=/mnt --exclude=/sys --exclude=/dev --exclude=/run /` <br><br> [See below for OS Backup](#backup-the-os) |
| Auditing users and groups                | [See below for Auditing users and groups](#day-1-part-2-auditing-users-and-groups) |
| Updating and enforcing password policies | [See below for Updating and enforcing password policies](#day-1-part-3-updating-and-enforcing-password-policies) |
| Updating and enforcing sudo permissions  | [See below for Updating and Enforcing sudo Permissions](#day-1-part-4-updating-and-enforcing-sudo-permissions) |
| Validating and updating permissions on files and directories | [See below for Validating and Updating Permissions on Files and Directories](#day-1-part-5-validating-and-updating-permissions-on-files-and-directories) |
| Optional: Updating password hashing configuration |                                               |
| Auditing and securing SSH                | [See below for Auditing and Securing SSH](#day-2-part-1-auditing-and-securing-ssh) |
| Reviewing and updating system packages   | [See below for Review, Update, and Add System Packages](#day-2-part-2--review-update-and-add-system-packages) |
| **Disabling unnecessary services**       | [See below for Disabling Unnecessary Services](#day-2-part-3-disabling-unnecessary-services) |
| **Enabling and configuring logging**     | [See below for Enabling and Configuring Logging](#day-2-part-4-enabling-and-configuring-logging) |
| **Scripts created**                      | `container_connect.sh           # To connect to the docker`<br>`container_start.sh             # To start the docker`<br>`hardening_script_1.sh          # Day 3 hardening script`<br>`hardening_script_2.sh          # Day 3 hardening script`<br>`keepalive.sh                   # Run on VM to keep SSH alive`<br>`preferences_and_tools_to_send  # A dotfile-type script to set up my environment the way I like, including $PS1 prompt and history` |
| **Scripts scheduled with cron**          | [See below for Scheduling the Hardening Scripts](#day-3-part-2-scheduling-the-hardening-scripts) |

<br>

## Project Commencement and Notes

NB: by default, default login is passwordless root. All commands following were performed as the root user.

First things first, upon starting and connecting to the docker container in which this project is contained, DNS resolution is noticeably slow. This was determined by running:

`apt update`

Time time it took to connect to the apt repository was approximately **20 seconds**, leading me to believe that `/etc/resolv.conf` was misconfigured. To "resolve" this (get it?), I ran the following:

```bash
root in ~ on Baker_Street_Linux_Server>  cat /etc/resolv.conf
# Generated by Docker Engine.
# This file can be edited; Docker Engine will not make further changes once it
# has been modified.

nameserver 8.8.8.8
nameserver 127.0.0.53
search ec2.internal

# Based on host file: '/etc/resolv.conf'
# Overrides: []

root in ~ on Baker_Street_Linux_Server>
```

Note that the default nameserver for DNS resolution is 8.8.8.8. This DNS resolver is owned by Google, and Google's 8.8.8.8 is typically fast, but the EC2 instance may have better performance using the AWS-provided DNS. I replace it with Amazon's internal resolver.

```bash
root in ~ on Baker_Street_Linux_Server>  cat /etc/resolv.conf
# Generated by Docker Engine.
# This file can be edited; Docker Engine will not make further changes once it
# has been modified.

#nameserver 8.8.8.8
nameserver 169.254.169.253  # AWS VPC Resolver
nameserver 127.0.0.53
search ec2.internal

# Based on host file: '/etc/resolv.conf'
# Overrides: []

root in ~ on Baker_Street_Linux_Server>
```

The /etc/resolv.conf file comments that "This file can be edited; Docker Engine will not make further changes", so I believe it. Just to double-check, I want to make sure that I'm not using systemd-resolved, nscd, or dnsmasq services on this machine. They would prevent my changes to /etc/resolv.conf from being persistent after reboots, if they're in use.

```bash
root in ~ on Baker_Street_Linux_Server>  systemctl is-active nsdcd
System has not been booted with systemd as init system (PID 1). Can't operate.
Failed to connect to bus: Host is down

root in ~ on Baker_Street_Linux_Server>
```

OK, from this we know that our system is **not using systemd**. This means commands like systemctl won't work. Instead, we can manually check for nscd and dnsmasq using more traditional methods.

### Check if nscd is running
```bash
root in ~ on Baker_Street_Linux_Server>  ps aux | grep nscd | grep -v grep

root in ~ on Baker_Street_Linux_Server>
```
Nothing is returned, nscd is **not running**

### Check if dnsmasq is running
```bash
root in ~ on Baker_Street_Linux_Server>  ps aux | grep dnsmasq | grep -v grep

root in ~ on Baker_Street_Linux_Server>
```
Nothing is returned, dnsmasq is **not running**

If **neither nscd nor dnsmasq are running**, then our DNS resolution relies purely on /etc/resolv.conf, meaning changes take effect immediately without restarting any services.

Since our system **does not use systemd**, systemd-resolved is likely **not running**, but we should confirm with the check:

### Check if systemd-resolved is running
```bash
root in ~ on Baker_Street_Linux_Server>  ps aux | grep systemd-resolved | grep -v grep

root in ~ on Baker_Street_Linux_Server>
```
Nothing is returned, systemd-resolved is **not running**

The service systemd-resolved can overwrite our changes to /etc/resolv.conf. That is the reason we want to check for its presence. Finally, let's check to see if /etc/resolv.conf is a symbolic link.

```bash
root in ~ on Baker_Street_Linux_Server>  ls -l /etc/resolv.conf
-rw-r--r-- 1 root root 298 Feb 28 17:40 /etc/resolv.conf

root in ~ on Baker_Street_Linux_Server>
```

Since we don't see:
`/etc/resolv.conf -> ../run/systemd/resolve/stub-resolv.conf`
or similar, we know that it's **not** a symbolic link and can infer that no service is **managing DNS** that might overwrite our changes. Safe there. I do a final check for new DNS resolution speed.

```bash
root in ~ on Baker_Street_Linux_Server>  time apt update
Hit:1 http://security.ubuntu.com/ubuntu jammy-security InRelease
Hit:2 http://archive.ubuntu.com/ubuntu jammy InRelease
Hit:3 http://archive.ubuntu.com/ubuntu jammy-updates InRelease
Hit:4 http://archive.ubuntu.com/ubuntu jammy-backports InRelease
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
4 packages can be upgraded. Run 'apt list --upgradable' to see them.

real    0m2.997s
user    0m2.574s
sys     0m0.429s

root in ~ on Baker_Street_Linux_Server>
```

Down from **20 seconds** to approximately **3 seconds**. Huge improvement and speed boost going forward for tasks I will need to complete.

<br>

## Day 1 Part 1: Pre-Hardening Steps

Complete the following (get the specs):
  - Hostname
  - OS Version
  - Memory Information
  - Uptime Information

### Get the Hostname
```bash
root in ~ on Baker_Street_Linux_Server>  hostname
Baker_Street_Linux_Server

root in ~ on Baker_Street_Linux_Server>
```

### OS Version
```bash
root in ~ on Baker_Street_Linux_Server>  cat /etc/os-release
PRETTY_NAME="Ubuntu 22.04.5 LTS"
NAME="Ubuntu"
VERSION_ID="22.04"
VERSION="22.04.5 LTS (Jammy Jellyfish)"
VERSION_CODENAME=jammy
ID=ubuntu
ID_LIKE=debian
HOME_URL="https://www.ubuntu.com/"
SUPPORT_URL="https://help.ubuntu.com/"
BUG_REPORT_URL="https://bugs.launchpad.net/ubuntu/"
PRIVACY_POLICY_URL="https://www.ubuntu.com/legal/terms-and-policies/privacy-policy"
UBUNTU_CODENAME=jammy

root in ~ on Baker_Street_Linux_Server>  lsb_release -a
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 22.04.5 LTS
Release:        22.04
Codename:       jammy

root in ~ on Baker_Street_Linux_Server>
```

### Memory Information
```bash
root in ~ on Baker_Street_Linux_Server>  free -h
               total        used        free      shared  buff/cache   available
Mem:            15Gi       991Mi        12Gi       203Mi       2.0Gi        13Gi
Swap:             0B          0B          0B

root in ~ on Baker_Street_Linux_Server>  vmstat -s
     16182788 K total memory
      1019768 K used memory
       781832 K active memory
      1807632 K inactive memory
     13083164 K free memory
       394956 K buffer memory
      1684900 K swap cache
            0 K total swap
            0 K used swap
            0 K free swap
        91514 non-nice user cpu ticks
          208 nice user cpu ticks
        37698 system cpu ticks
      3117447 idle cpu ticks
         5544 IO-wait cpu ticks
            0 IRQ cpu ticks
         3503 softirq cpu ticks
        82917 stolen cpu ticks
      1535907 pages paged in
      1002705 pages paged out
            0 pages swapped in
            0 pages swapped out
      4031324 interrupts
      5669941 CPU context switches
   1741278239 boot time
        99339 forks

root in ~ on Baker_Street_Linux_Server>  awk '/MemTotal|MemFree|Buffers|Cached/ {print $1, $2/1024, "MB"}' /proc/meminfo
MemTotal: 15803.5 MB
MemFree: 12783.4 MB
Buffers: 385.602 MB
Cached: 1404.38 MB
SwapCached: 0 MB

root in ~ on Baker_Street_Linux_Server> top
top - 18:47:08 up  2:23,  0 users,  load average: 0.21, 0.30, 0.29
Tasks:   6 total,   1 running,   5 sleeping,   0 stopped,   0 zombie
%Cpu(s):  1.8 us,  0.7 sy,  0.0 ni, 94.8 id,  0.0 wa,  0.0 hi,  0.0 si,  2.7 st
MiB Mem :  15803.5 total,  12774.0 free,    994.4 used,   2035.1 buff/cache
MiB Swap:      0.0 total,      0.0 free,      0.0 used.  14259.5 avail Mem

    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
      1 root      20   0    4364   3100   2852 S   0.0   0.0   0:00.03 start_services.
     44 root      20   0    2824   1024    936 S   0.0   0.0   0:00.34 tail
     45 root      20   0    4628   3884   3248 S   0.0   0.0   0:00.08 bash
    404 root      20   0    4760   4048   3236 S   0.0   0.0   0:00.16 bash
    900 root      20   0    4760   4040   3256 S   0.0   0.0   0:00.11 bash
   1361 root      20   0    7344   3284   2716 R   0.0   0.0   0:00.01 top

root in ~ on Baker_Street_Linux_Server>
```

### Uptime Information
```bash
root in ~ on Baker_Street_Linux_Server>  uptime
 18:49:17 up  2:25,  0 users,  load average: 0.17, 0.26, 0.27

root in ~ on Baker_Street_Linux_Server>
```

Now, backup the OS with specific directory exclusions.

### Backup the OS
```bash
tar -cvpzf /baker_street_backup_$(date +%F).tar.gz --exclude=/baker_street_backup* --exclude=/proc --exclude=/tmp --exclude=/mnt --exclude=/sys --exclude=/dev --exclude=/run /
```

#### Breakdown of the tar backup command:
  - **tar**: The command used to create a compressed archive.
  - **-cvpzf**:
    - **c**: Create a new archive.
    - **v**: Verbose output (lists files being archived).
    - **p**: Preserves the file permissions.
    - **z**: Compress with gzip.
    - **f**: Specifies the filename of the archive.
  - **/baker_street_backup_$(date +%F).tar.gz**: This sets the backup file name to baker_street_backup_YYYY-MM-DD.tar.gz, where $(date +%F) dynamically adds the current date.
  - **--exclude=/baker_street_backup***: Excludes any previous backups (based on my naming pattern).
  - **--exclude=/proc --exclude=/tmp --exclude=/mnt --exclude=/sys --exclude=/dev --exclude=/run**: Excludes directories that should not be included in the backup (e.g., temporary or system directories).
  - **/**: Archives the entire filesystem starting from the root /.

<br>

## Day 1 Part 2: Auditing Users and Groups

Given:
| Name       | Status               |
|------------|----------------------|
| sherlock   | Employed             |
| watson     | Employed             |
| mycroft    | Employed             |
| moriarty   | On temporary leave   |
| lestrade   | Terminated           |
| irene      | Terminated           |
| mrs_hudson | On temporary leave   |
| mary       | Terminated           |
| gregson    | Terminated           |
| toby       | Employed             |
| adler      | Employed             |

### Remove Terminated Users
The following employees have been terminated and must be removed along with their home directories and files:
  - lestrade, irene, mary, gregson
```bash
userdel -r lestrade
userdel -r irene
userdel -r mary
userdel -r gregson
```

### Lock Accounts on Temporary Leave
The following employees are on temporary leave and must be locked:
  - moriarty, mrs_hudson
```bash
root in ~ on Baker_Street_Linux_Server>  usermod -L moriarty
root in ~ on Baker_Street_Linux_Server>  usermod -L mrs_hudson

# Verification Check to see if users are locked (they should have ! or L in the password field in /etc/shadow):
root in ~ on Baker_Street_Linux_Server>  passwd -S moriarty
moriarty L 01/01/1970 0 99999 7 -1

root in ~ on Baker_Street_Linux_Server>  passwd -S mrs_hudson
mrs_hudson L 01/01/1970 0 99999 7 -1

root in ~ on Baker_Street_Linux_Server>  grep -E "^(moriarty|mrs_hudson):" /etc/shadow
moriarty:!$y$j9T$ViTFRGgYRvlxei2pQJlpP/$EV2CooYcXV7lZA5BJDWA7ND6sExw/ppBPIVDLxtA5AC:20144:0:99999:7:::
mrs_hudson:!:20069:0:99999:7:::
```

### Unlock Employed Users
The following employees must be unlocked to ensure they have access:
  - sherlock, watson, mycroft, toby, adler
```bash
root in ~ on Baker_Street_Linux_Server>  usermod -U sherlock
root in ~ on Baker_Street_Linux_Server>  usermod -U watson
root in ~ on Baker_Street_Linux_Server>  usermod -U mycroft
root in ~ on Baker_Street_Linux_Server>  usermod -U toby
root in ~ on Baker_Street_Linux_Server>  usermod -U adler
```

### Move Marketing Employees to Research Group
```bash
# Check if research group exists, and create if necessary:
getent group research || groupadd research

# Remaining List of Users:
# sherlock
# watson
# moriarty
# mycroft
# mrs_hudson
# toby
# adler

# See if any of these users are in the marketing group:
id sherlock
id watson
id moriarty
id mycroft
id mrs_hudson
id toby
id adler

# None of these users are in marketing group, so let's see if it even exists
root in ~ on Baker_Street_Linux_Server>  getent group marketing
marketing:x:1014:

# From this we can determine that either
#   1) No users were assigned to the marketing group
#   2) The users were remove from the group earlier

# Since the marketing gropu is empty, we can safely remove it:
groupdel marketing

# Verify Deletion:
root in ~ on Baker_Street_Linux_Server>  getent group marketing

root in ~ on Baker_Street_Linux_Server>
```

<br>

## Day 1 Part 3: Updating and Enforcing Password Policies

Update the password requirements for all users to have:
  - Minimum 8 characters
  - At least one special character
  - Allow 2 retries
  - At least one uppercase character
```bash
Step 1: Edit Password Policy in /etc/pam.d/common-password
We'll update the pam_pwquality.so module to enforce the following rules:
    - Minimum 8 characters
    - At least 1 special characetr
    - Allow 2 retries
    - At least 1 uppercase character

Command(s):
nano /etc/pam.d/common-password
Find the line that starts with:
password requisite pam_pwquality.so

Since there is no line that includes the search term pam_pwquality.so, let's create it:

Paste the following line at the end of the file:
password requisite pam_pwquality.so retry=2 minlen=8 ucredit=-1 ocredit=-1

(Notes on these parameters):
    -   retry=2 → Users can retry password entry twice before failure.
    -   minlen=8 → Passwords must be at least 8 characters long.
    -   ucredit=-1 → Require at least one uppercase letter.
    -   ocredit=-1 → Require at least one special character (!@#$%^&*, etc.).

(Don't need to restart any services after editing & saving the /etc/pam.d/common-password file)

Step 2: Force Users to Change Passwords on Next Login

Command(s) to Force Password Change for a user:
chage -d 0 <username>

chage -d 0 sherlock
chage -d 0 watson
chage -d 0 moriarty
chage -d 0 mycroft
chage -d 0 mrs_hudson
chage -d 0 toby
chage -d 0 adler

# To verify, check each user's password expiration status:
root in ~ on Baker_Street_Linux_Server>  chage -l watson
Last password change                               : password must be changed
Password expires                                   : password must be changed
Password inactive                                  : password must be changed
Account expires                                    : never
Minimum number of days between password change     : 0
Maximum number of days between password change     : 99999
Number of days of warning before password expires  : 7

root in ~ on Baker_Street_Linux_Server>  cat /etc/pam.d/common-password
#
# /etc/pam.d/common-password - password-related modules common to all services
#
# This file is included from other service-specific PAM config files,
# and should contain a list of modules that define the services to be
# used to change user passwords.  The default is pam_unix.

# Explanation of pam_unix options:
# The "yescrypt" option enables
#hashed passwords using the yescrypt algorithm, introduced in Debian
#11.  Without this option, the default is Unix crypt.  Prior releases
#used the option "sha512"; if a shadow password hash will be shared
#between Debian 11 and older releases replace "yescrypt" with "sha512"
#for compatibility .  The "obscure" option replaces the old
#`OBSCURE_CHECKS_ENAB' option in login.defs.  See the pam_unix manpage
#for other options.

# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.
# To take advantage of this, it is recommended that you configure any
# local modules either before or after the default block, and use
# pam-auth-update to manage selection of other modules.  See
# pam-auth-update(8) for details.

# here are the per-package modules (the "Primary" block)
password    [success=1 default=ignore]  pam_unix.so obscure yescrypt
# here's the fallback if no module succeeds
password    requisite           pam_deny.so
# prime the stack with a positive return value if there isn't one already;
# this avoids us returning an error just because nothing sets a success code
# since the modules above will each just jump around
password    required            pam_permit.so
# and here are more per-package modules (the "Additional" block)
# end of pam-auth-update config
password requisite pam_pwquality.so retry=2 minlen=8 ucredit=-1 ocredit=-1
```

<br>

## Day 1 Part 4: Updating and Enforcing sudo Permissions

```bash

# Step 1: Remove all users except sherlock from full sudo access

# List all users with sudo privileges:
root in ~ on Baker_Street_Linux_Server>  getent group sudo
sudo:x:27:

# Currently, no users are in sudo

# * Critical error in Broen's logic found here:
# getent group sudo only checks /etc/group, which lists users assigned to the sudo group.
# Watson and Moriarty had sudo access because of explicit rules in /etc/sudoers, not because they were in the sudo group.

# How to check all users with sudo access?
# sudo -l -U <username>

# So:

sudo -l -U sherlock
sudo -l -U watson
sudo -l -U moriarty
sudo -l -U mycroft
sudo -l -U mrs_hudson
sudo -l -U toby
sudo -l -U adler

# Or an alternative would be:
root in ~ on Baker_Street_Linux_Server>  grep -E '^[^#].*(ALL)' /etc/sudoers /etc/sudoers.d/* 2>/dev/null
/etc/sudoers:root   ALL=(ALL:ALL) ALL
/etc/sudoers:%admin ALL=(ALL) ALL
/etc/sudoers:%sudo  ALL=(ALL:ALL) ALL
/etc/sudoers:sherlock ALL=(ALL) NOPASSWD:ALL
/etc/sudoers:watson ALL=(ALL) NOPASSWD:ALL
/etc/sudoers:moriarty ALL=(ALL) NOPASSWD:ALL
/etc/sudoers:watson, mycroft ALL=(ALL) NOPASSWD: /var/log/logcleanup.sh

root in ~ on Baker_Street_Linux_Server>

# This verifies that watson and moriarty still have full sudo access, via the sudoers file
# Let's edit that safely:
root in ~ on Baker_Street_Linux_Server>  visudo

# Find and delete these lines:
watson ALL=(ALL) NOPASSWD:ALL
moriarty ALL=(ALL) NOPASSWD:ALL

# Add sherlock user to sudo group, and verify:
root in ~ on Baker_Street_Linux_Server>  usermod -aG sudo sherlock
root in ~ on Baker_Street_Linux_Server>  getent group sudo
sudo:x:27:sherlock

root in ~ on Baker_Street_Linux_Server>

# Allow Watson and Mycroft to run only the script /var/log/logcleanup.sh with sudo privileges.

# Open the sudoers file safely, using visudo (to prevent syntax errors):
root in ~ on Baker_Street_Linux_Server>  visudo

# At the end of the file, paste the following line:
watson, mycroft ALL=(ALL) NOPASSWD: /var/log/logcleanup.sh

# Save and exit the file.

# Verify who has sudo access with the grep command:
root in ~ on Baker_Street_Linux_Server>  grep -E '^[^#].*(ALL)' /etc/sudoers /etc/sudoers.d/* 2>/dev/null
/etc/sudoers:root   ALL=(ALL:ALL) ALL
/etc/sudoers:%admin ALL=(ALL) ALL
/etc/sudoers:%sudo  ALL=(ALL:ALL) ALL
/etc/sudoers:sherlock ALL=(ALL) NOPASSWD:ALL
/etc/sudoers:watson, mycroft ALL=(ALL) NOPASSWD: /var/log/logcleanup.sh

root in ~ on Baker_Street_Linux_Server>

# Next step, all employees who belong to the research group should have sudo prvileges to run the following script:
/tmp/scripts/research_script.sh

# Since no one belongs to the research group currently, let's add adler and toby:
root in ~ on Baker_Street_Linux_Server>  usermod -aG research adler
root in ~ on Baker_Street_Linux_Server>  usermod -aG research toby

# Again, use visudo to prevent syntax errors:
root in ~ on Baker_Street_Linux_Server>  visudo

# Add the following line to the end of the file:
%research ALL=(ALL) NOPASSWD: /tmp/scripts/research_script.sh

# Verify if users, e.g. adler, can now run the script:
root in ~ on Baker_Street_Linux_Server>  sudo -l -U adler
User adler may run the following commands on Baker_Street_Linux_Server:
    (ALL) NOPASSWD: /tmp/scripts/research_script.sh

root in ~ on Baker_Street_Linux_Server>
```

<br>

## Day 1 Part 5: Validating and Updating Permissions on Files and Directories
```bash
# Step 1: Remove World Permissions from Files in Users' Home Directories

# Find all files in /home that have world (other) read (r), write (w), or execute (x) permissions:
find /home -type f -perm /o=rwx

# Remove world permissions from these files, using the same find command:
find /home -type f -perm /o=rwx -exec chmod o-rwx {} \;

# Step 2: Restrict Access to Engineering Scripts

# Find all scripts with 'engineering' in the filename (case-insensitive)
find / -type f -iname "*engineering*" 2>/dev/null

# Output:
# /home/adler/Engineering_script.sh_script1.sh
# /home/adler/Engineering_script.sh_0.txt
# /home/adler/Engineering_script.sh_3.txt
# /home/adler/Engineering_script.sh_script2.sh
# /home/mycroft/Engineering_script.sh_0.txt
# /home/toby/Engineering_script.sh_2.txt
# /home/mrs_hudson/Engineering_script.sh_1.txt

# Change the ownership of all these scripts to the engineering group
chown :engineering /home/adler/Engineering_script.sh_script1.sh
chown :engineering /home/adler/Engineering_script.sh_0.txt
chown :engineering /home/adler/Engineering_script.sh_3.txt
chown :engineering /home/adler/Engineering_script.sh_script2.sh
chown :engineering /home/mycroft/Engineering_script.sh_0.txt
chown :engineering /home/toby/Engineering_script.sh_2.txt
chown :engineering /home/mrs_hudson/Engineering_script.sh_1.txt

# Set the correct permissions for all these scripts
chmod 750 /home/adler/Engineering_script.sh_script1.sh
chmod 750 /home/adler/Engineering_script.sh_script2.sh
chmod 750 /home/adler/Engineering_script.sh_0.txt
chmod 750 /home/adler/Engineering_script.sh_3.txt
chmod 750 /home/mycroft/Engineering_script.sh_0.txt
chmod 750 /home/toby/Engineering_script.sh_2.txt
chmod 750 /home/mrs_hudson/Engineering_script.sh_1.txt

# Find all research scripts:
find / -type f -iname "*research*" 2>/dev/null

# Output:
# /usr/share/ca-certificates/mozilla/Hellenic_Academic_and_Research_Institutions_RootCA_2015.crt
# /usr/share/ca-certificates/mozilla/Hellenic_Academic_and_Research_Institutions_ECC_RootCA_2015.crt
# /tmp/scripts/research_script.sh

# We don't want to mess with the CA Certs, so just:
# Change owner of these scripts to research group:
chown :research /tmp/scripts/research_script.sh

# Change permissions:
chmod 750 /tmp/scripts/research_script.sh

# Find all finance scripts:
find / -type f -iname "*finance*" 2>/dev/null

# Output:
# /home/moriarty/Finance_script.sh_2.txt
# /home/moriarty/Finance_script.sh_0.txt
# /home/mycroft/Finance_script.sh_3.txt
# /home/mycroft/Finance_script.sh_script2.sh
# /home/mycroft/Finance_script.sh_script1.sh
# /home/watson/Finance_script.sh_3.txt
# /home/watson/Finance_script.sh_script2.sh
# /home/watson/Finance_script.sh_script1.sh

# Change owner of these scripts to finance group:
chown :finance /home/moriarty/Finance_script.sh_2.txt
chown :finance /home/moriarty/Finance_script.sh_0.txt
chown :finance /home/mycroft/Finance_script.sh_3.txt
chown :finance /home/mycroft/Finance_script.sh_script2.sh
chown :finance /home/mycroft/Finance_script.sh_script1.sh
chown :finance /home/watson/Finance_script.sh_3.txt
chown :finance /home/watson/Finance_script.sh_script2.sh
chown :finance /home/watson/Finance_script.sh_script1.sh

# Change permissions:
chmod 750 /home/moriarty/Finance_script.sh_2.txt
chmod 750 /home/moriarty/Finance_script.sh_0.txt
chmod 750 /home/mycroft/Finance_script.sh_3.txt
chmod 750 /home/mycroft/Finance_script.sh_script2.sh
chmod 750 /home/mycroft/Finance_script.sh_script1.sh
chmod 750 /home/watson/Finance_script.sh_3.txt
chmod 750 /home/watson/Finance_script.sh_script2.sh
chmod 750 /home/watson/Finance_script.sh_script1.sh

# Final Step: Finding and Removing Hidden Password Files

find /home -type f \( -iname ".*pass*" -o -iname ".*cred*" -o -iname ".*secret*" -o -iname ".*login*" \) 2>/dev/null
# Output:
#     (null)

find /home -type f \( -iname "*pass*" -o -iname "*cred*" -o -iname "*secret*" -o -iname "*login*" \) 2>/dev/null
# Output:
#     (null)

root in /home on Baker_Street_Linux_Server>  ll *
adler:
total 36
drwxr-x--- 1 adler adler 4096 Dec 12 07:45 ./
drwxr-xr-x 1 root  root  4096 Feb 25 02:14 ../
-rw-r----- 1 adler adler  220 Jan  6  2022 .bash_logout
-rw-r----- 1 adler adler 3771 Jan  6  2022 .bashrc
-rw-r----- 1 adler adler  807 Jan  6  2022 .profile
-rwxr-x--- 1 root  root     0 Dec 12 07:45 Engineering_script.sh_0.txt*
-rwxr-x--- 1 root  root     0 Dec 12 07:45 Engineering_script.sh_3.txt*
-rwxr-x--- 1 root  root    46 Dec 12 07:45 Engineering_script.sh_script1.sh*
-rwxr-x--- 1 root  root    46 Dec 12 07:45 Engineering_script.sh_script2.sh*
-rw-r----- 1 root  root     0 Dec 12 07:45 deduction.doc_2.txt
-rw-r----- 1 root  root     0 Dec 12 07:45 game_is_afoot.txt_1.txt

moriarty:
total 36
drwxr-x--- 1 moriarty moriarty 4096 Dec 12 07:45 ./
drwxr-xr-x 1 root     root     4096 Feb 25 02:14 ../
-rw-r----- 1 moriarty moriarty  220 Jan  6  2022 .bash_logout
-rw-r----- 1 moriarty moriarty 3771 Jan  6  2022 .bashrc
-rw-r----- 1 moriarty moriarty  807 Jan  6  2022 .profile
-rw-r----- 1 root     root        0 Dec 12 07:45 Finance_script.sh_0.txt
-rw-r----- 1 root     root        0 Dec 12 07:45 Finance_script.sh_2.txt
-rw-r----- 1 root     root        0 Dec 12 07:45 elementary.txt_1.txt
-rw-r----- 1 root     root        0 Dec 12 07:45 game_is_afoot.txt_3.txt
-rwxr-x--- 1 root     root       49 Dec 12 07:45 game_is_afoot.txt_script1.sh*
-rwxr-x--- 1 root     root       49 Dec 12 07:45 game_is_afoot.txt_script2.sh*
-rw-r----- 1 root     root        0 Dec 12 07:45 my_file.txt

mrs_hudson:
total 36
drwxr-x--- 1 mrs_hudson mrs_hudson 4096 Dec 12 07:45 ./
drwxr-xr-x 1 root       root       4096 Feb 25 02:14 ../
-rw-r----- 1 mrs_hudson mrs_hudson  220 Jan  6  2022 .bash_logout
-rw-r----- 1 mrs_hudson mrs_hudson 3771 Jan  6  2022 .bashrc
-rw-r----- 1 mrs_hudson mrs_hudson  807 Jan  6  2022 .profile
-rwxr-x--- 1 root       root          0 Dec 12 07:45 Engineering_script.sh_1.txt*
-rw-r----- 1 root       root          0 Dec 12 07:45 deduction.doc_0.txt
-rw-r----- 1 root       root          0 Dec 12 07:45 deduction.doc_2.txt
-rw-r----- 1 root       root          0 Dec 12 07:45 elementary.txt_3.txt
-rwxr-x--- 1 root       root         51 Dec 12 07:45 elementary.txt_script1.sh*
-rwxr-x--- 1 root       root         51 Dec 12 07:45 elementary.txt_script2.sh*

mycroft:
total 36
drwxr-x--- 1 mycroft mycroft 4096 Dec 12 07:45 ./
drwxr-xr-x 1 root    root    4096 Feb 25 02:14 ../
-rw-r----- 1 mycroft mycroft  220 Jan  6  2022 .bash_logout
-rw-r----- 1 mycroft mycroft 3771 Jan  6  2022 .bashrc
-rw-r----- 1 mycroft mycroft  807 Jan  6  2022 .profile
-rwxr-x--- 1 root    root       0 Dec 12 07:45 Engineering_script.sh_0.txt*
-rw-r----- 1 root    root       0 Dec 12 07:45 Finance_script.sh_3.txt
-rwxr-x--- 1 root    root      48 Dec 12 07:45 Finance_script.sh_script1.sh*
-rwxr-x--- 1 root    root      48 Dec 12 07:45 Finance_script.sh_script2.sh*
-rw-r----- 1 root    root       0 Dec 12 07:45 deduction.doc_1.txt
-rw-r----- 1 root    root       0 Dec 12 07:45 deduction.doc_2.txt

sherlock:
total 36
drwxr-x--- 1 sherlock sherlock 4096 Dec 12 07:45 ./
drwxr-xr-x 1 root     root     4096 Feb 25 02:14 ../
-rw-r----- 1 sherlock sherlock  220 Jan  6  2022 .bash_logout
-rw-r----- 1 sherlock sherlock 3771 Jan  6  2022 .bashrc
-rw-r----- 1 sherlock sherlock  807 Jan  6  2022 .profile
-rw-r----- 1 root     root        0 Dec 12 07:45 deduction.doc_3.txt
-rwxr-x--- 1 root     root       49 Dec 12 07:45 deduction.doc_script1.sh*
-rwxr-x--- 1 root     root       49 Dec 12 07:45 deduction.doc_script2.sh*
-rw-r----- 1 root     root        0 Dec 12 07:45 elementary.txt_0.txt
-rw-r----- 1 root     root        0 Dec 12 07:45 game_is_afoot.txt_1.txt
-rw-r----- 1 root     root        0 Dec 12 07:45 game_is_afoot.txt_2.txt
-rw-r----- 1 root     root        0 Dec 12 07:45 my_file.txt

sysadmin:
total 28
drwxr-x--- 1 sysadmin sysadmin 4096 Dec 12 07:45 ./
drwxr-xr-x 1 root     root     4096 Feb 25 02:14 ../
-rw-r----- 1 sysadmin sysadmin  220 Jan  6  2022 .bash_logout
-rw-r----- 1 sysadmin sysadmin 3771 Jan  6  2022 .bashrc
-rw-r----- 1 sysadmin sysadmin  807 Jan  6  2022 .profile

toby:
total 36
drwxr-x--- 1 toby toby 4096 Dec 12 07:45 ./
drwxr-xr-x 1 root root 4096 Feb 25 02:14 ../
-rw-r----- 1 toby toby  220 Jan  6  2022 .bash_logout
-rw-r----- 1 toby toby 3771 Jan  6  2022 .bashrc
-rw-r----- 1 toby toby  807 Jan  6  2022 .profile
-rwxr-x--- 1 root root    0 Dec 12 07:45 Engineering_script.sh_2.txt*
-rw-r----- 1 root root    0 Dec 12 07:45 deduction.doc_1.txt
-rw-r----- 1 root root    0 Dec 12 07:45 elementary.txt_0.txt
-rw-r----- 1 root root    0 Dec 12 07:45 elementary.txt_3.txt
-rwxr-x--- 1 root root   45 Dec 12 07:45 elementary.txt_script1.sh*
-rwxr-x--- 1 root root   45 Dec 12 07:45 elementary.txt_script2.sh*

watson:
total 36
drwxr-x--- 1 watson watson 4096 Dec 12 07:45 ./
drwxr-xr-x 1 root   root   4096 Feb 25 02:14 ../
-rw-r----- 1 watson watson  220 Jan  6  2022 .bash_logout
-rw-r----- 1 watson watson 3771 Jan  6  2022 .bashrc
-rw-r----- 1 watson watson  807 Jan  6  2022 .profile
-rw-r----- 1 root   root      0 Dec 12 07:45 Finance_script.sh_3.txt
-rwxr-x--- 1 root   root     47 Dec 12 07:45 Finance_script.sh_script1.sh*
-rwxr-x--- 1 root   root     47 Dec 12 07:45 Finance_script.sh_script2.sh*
-rw-r----- 1 root   root      0 Dec 12 07:45 deduction.doc_0.txt
-rw-r----- 1 root   root      0 Dec 12 07:45 deduction.doc_1.txt
-rw-r----- 1 root   root      0 Dec 12 07:45 deduction.doc_2.txt
-rw-r----- 1 root   root      0 Dec 12 07:45 my_file.txt

# Find all 0 bytes files in /home directory and all of its subdirectories to clean up the mess:
find /home -type f -size 0

# Remove all 0 bytes files in /home directory and all of its subdirectories to clean up the mess:
find /home -type f -size 0 -exec rm -f {} \;

# Now check to see what we are working with:
root in /home on Baker_Street_Linux_Server>  ll *
adler:
total 36
drwxr-x--- 1 adler adler 4096 Feb 25 03:57 ./
drwxr-xr-x 1 root  root  4096 Feb 25 02:14 ../
-rw-r----- 1 adler adler  220 Jan  6  2022 .bash_logout
-rw-r----- 1 adler adler 3771 Jan  6  2022 .bashrc
-rw-r----- 1 adler adler  807 Jan  6  2022 .profile
-rwxr-x--- 1 root  root    46 Dec 12 07:45 Engineering_script.sh_script1.sh*
-rwxr-x--- 1 root  root    46 Dec 12 07:45 Engineering_script.sh_script2.sh*

moriarty:
total 36
drwxr-x--- 1 moriarty moriarty 4096 Feb 25 03:57 ./
drwxr-xr-x 1 root     root     4096 Feb 25 02:14 ../
-rw-r----- 1 moriarty moriarty  220 Jan  6  2022 .bash_logout
-rw-r----- 1 moriarty moriarty 3771 Jan  6  2022 .bashrc
-rw-r----- 1 moriarty moriarty  807 Jan  6  2022 .profile
-rwxr-x--- 1 root     root       49 Dec 12 07:45 game_is_afoot.txt_script1.sh*
-rwxr-x--- 1 root     root       49 Dec 12 07:45 game_is_afoot.txt_script2.sh*

mrs_hudson:
total 36
drwxr-x--- 1 mrs_hudson mrs_hudson 4096 Feb 25 03:57 ./
drwxr-xr-x 1 root       root       4096 Feb 25 02:14 ../
-rw-r----- 1 mrs_hudson mrs_hudson  220 Jan  6  2022 .bash_logout
-rw-r----- 1 mrs_hudson mrs_hudson 3771 Jan  6  2022 .bashrc
-rw-r----- 1 mrs_hudson mrs_hudson  807 Jan  6  2022 .profile
-rwxr-x--- 1 root       root         51 Dec 12 07:45 elementary.txt_script1.sh*
-rwxr-x--- 1 root       root         51 Dec 12 07:45 elementary.txt_script2.sh*

mycroft:
total 36
drwxr-x--- 1 mycroft mycroft 4096 Feb 25 03:57 ./
drwxr-xr-x 1 root    root    4096 Feb 25 02:14 ../
-rw-r----- 1 mycroft mycroft  220 Jan  6  2022 .bash_logout
-rw-r----- 1 mycroft mycroft 3771 Jan  6  2022 .bashrc
-rw-r----- 1 mycroft mycroft  807 Jan  6  2022 .profile
-rwxr-x--- 1 root    root      48 Dec 12 07:45 Finance_script.sh_script1.sh*
-rwxr-x--- 1 root    root      48 Dec 12 07:45 Finance_script.sh_script2.sh*

sherlock:
total 36
drwxr-x--- 1 sherlock sherlock 4096 Feb 25 03:57 ./
drwxr-xr-x 1 root     root     4096 Feb 25 02:14 ../
-rw-r----- 1 sherlock sherlock  220 Jan  6  2022 .bash_logout
-rw-r----- 1 sherlock sherlock 3771 Jan  6  2022 .bashrc
-rw-r----- 1 sherlock sherlock  807 Jan  6  2022 .profile
-rwxr-x--- 1 root     root       49 Dec 12 07:45 deduction.doc_script1.sh*
-rwxr-x--- 1 root     root       49 Dec 12 07:45 deduction.doc_script2.sh*

sysadmin:
total 28
drwxr-x--- 1 sysadmin sysadmin 4096 Dec 12 07:45 ./
drwxr-xr-x 1 root     root     4096 Feb 25 02:14 ../
-rw-r----- 1 sysadmin sysadmin  220 Jan  6  2022 .bash_logout
-rw-r----- 1 sysadmin sysadmin 3771 Jan  6  2022 .bashrc
-rw-r----- 1 sysadmin sysadmin  807 Jan  6  2022 .profile

toby:
total 36
drwxr-x--- 1 toby toby 4096 Feb 25 03:57 ./
drwxr-xr-x 1 root root 4096 Feb 25 02:14 ../
-rw-r----- 1 toby toby  220 Jan  6  2022 .bash_logout
-rw-r----- 1 toby toby 3771 Jan  6  2022 .bashrc
-rw-r----- 1 toby toby  807 Jan  6  2022 .profile
-rwxr-x--- 1 root root   45 Dec 12 07:45 elementary.txt_script1.sh*
-rwxr-x--- 1 root root   45 Dec 12 07:45 elementary.txt_script2.sh*

watson:
total 36
drwxr-x--- 1 watson watson 4096 Feb 25 03:57 ./
drwxr-xr-x 1 root   root   4096 Feb 25 02:14 ../
-rw-r----- 1 watson watson  220 Jan  6  2022 .bash_logout
-rw-r----- 1 watson watson 3771 Jan  6  2022 .bashrc
-rw-r----- 1 watson watson  807 Jan  6  2022 .profile
-rwxr-x--- 1 root   root     47 Dec 12 07:45 Finance_script.sh_script1.sh*
-rwxr-x--- 1 root   root     47 Dec 12 07:45 Finance_script.sh_script2.sh*



# Now let's just cat all of the text files in the /home subdirectories for a visual check:
find /home -type f -exec cat {} \; 2>/dev/null | more

# Now let's just cat all of the text files (ignoring hidden files) to trim it down a bit more:
root in /home on Baker_Street_Linux_Server>  find /home -type f ! -name ".*" -exec cat {} \; 2>/dev/null | more
#!/bin/bash
echo 'This is a script for adler'
#!/bin/bash
echo 'This is a script for adler'
#!/bin/bash
echo 'This is a script for sherlock'
#!/bin/bash
echo 'This is a script for sherlock'
#!/bin/bash
echo 'This is a script for moriarty'
#!/bin/bash
echo 'This is a script for moriarty'
#!/bin/bash
echo 'This is a script for mycroft'
#!/bin/bash
echo 'This is a script for mycroft'
#!/bin/bash
echo 'This is a script for toby'
#!/bin/bash
echo 'This is a script for toby'
#!/bin/bash
echo 'This is a script for watson'
#!/bin/bash
echo 'This is a script for watson'
#!/bin/bash
echo 'This is a script for mrs_hudson'
#!/bin/bash
echo 'This is a script for mrs_hudson'


# Now let's try and find files outside of the home directory that are owned by any of these users,
# in-case that they were trying to hide things in /tmp for instance:
find / -path /home -prune -o -type f -not -user root -exec ls -l {} \; 2>/dev/null

# Explanation:
#  - / -path /home -prune -o → Excludes /home from the search (since we already checked it).
#  - -type f → Looks for files only (ignores directories).
#  - -not -user root → Finds files not owned by root (i.e., user-created files).
#  - -exec ls -l {} \; → Lists files with their owners and permissions.
#  - 2>/dev/null → Suppresses "Permission denied" errors.


find / -path /home -prune -o -type f -not -user root -not -user mysql -exec ls -l {} \; 2>/dev/null

# Explanation:
#  - -not -user mysql → also excludes user mysql

# In the end:
# Nothing found!
```

<br>

## Day 2 Part 1: Auditing and Securing SSH
Configure SSH to disallow the ability to:
  - SSH with empty passwords
  - SSH with the root user
  - SSH with any other ports besides 22
Configure SSH to enable:
  - SSH protocol 2
  
First, get the lay of the land:
```bash
root in /home on Baker_Street_Linux_Server>  grep -iE "^\s*#?\s*(permitempty|permitroot|port|protocol)" /etc/ssh/sshd_config
Port 21
PermitRootLogin yes
PermitEmptyPasswords yes
Port 2222
Port 2223
Port 2224
Port 2225

root in /home on Baker_Street_Linux_Server>
```

This is not good, because I see that SSH is allowing connectinos on Ports 21, 2222, 2223, 2224, 2225. The root user is allowed to ssh in, and users with empty passwords are allowed to ssh in. There's also no mention of the Protocol in the existing configuration.

Edit the /etc/ssh/sshd_config file to make the following changes (note: the grep command was run after I edited the file):
```bash
root in /home on Baker_Street_Linux_Server>  grep -iE "^\s*#?\s*(permitempty|permitroot|port|protocol)" /etc/ssh/sshd_config
Port 22
PermitRootLogin no
PermitEmptyPasswords no
#Port 2222
#Port 2223
#Port 2224
#Port 2225
Protocol 2

root in /home on Baker_Street_Linux_Server>
```

<br>

## Day 2 Part 2:  Review, Update, and Add System Packages
Configure system packages to:
  - Update the package manager
  - Upgrade all currently-installed packages to their latest versions
  - Create a file called package_list.txt to display all currently-installed packages
  - Remove the following packages: telnet, rsh-client
  - Remove all unnecessary package dependencies
  - Add the following packages: ufw, lynis, tripwire
  - Document the hardening features of the newly-installed packages: ufw, lynis, tripwire

### Use apt to Update and Upgrade
```bash
root in ~ on Baker_Street_Linux_Server>  apt update && apt upgrade -y
Hit:1 http://security.ubuntu.com/ubuntu jammy-security InRelease
Hit:2 http://archive.ubuntu.com/ubuntu jammy InRelease
Hit:3 http://archive.ubuntu.com/ubuntu jammy-updates InRelease
Hit:4 http://archive.ubuntu.com/ubuntu jammy-backports InRelease
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
4 packages can be upgraded. Run 'apt list --upgradable' to see them.
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
Calculating upgrade... Done
The following packages will be upgraded:
  libgssapi-krb5-2 libk5crypto3 libkrb5-3 libkrb5support0
4 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
Need to get 620 kB of archives.
After this operation, 0 B of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libk5crypto3 amd64 1.19.2-2ubuntu0.6 [86.5 kB]
Get:2 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libkrb5support0 amd64 1.19.2-2ubuntu0.6 [32.5 kB]
Get:3 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libkrb5-3 amd64 1.19.2-2ubuntu0.6 [357 kB]
Get:4 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libgssapi-krb5-2 amd64 1.19.2-2ubuntu0.6 [145 kB]
Fetched 620 kB in 1s (829 kB/s)
debconf: delaying package configuration, since apt-utils is not installed
(Reading database ... 14136 files and directories currently installed.)
Preparing to unpack .../libk5crypto3_1.19.2-2ubuntu0.6_amd64.deb ...
Unpacking libk5crypto3:amd64 (1.19.2-2ubuntu0.6) over (1.19.2-2ubuntu0.5) ...
Setting up libk5crypto3:amd64 (1.19.2-2ubuntu0.6) ...
(Reading database ... 14136 files and directories currently installed.)
Preparing to unpack .../libkrb5support0_1.19.2-2ubuntu0.6_amd64.deb ...
Unpacking libkrb5support0:amd64 (1.19.2-2ubuntu0.6) over (1.19.2-2ubuntu0.5) ...
Setting up libkrb5support0:amd64 (1.19.2-2ubuntu0.6) ...
(Reading database ... 14136 files and directories currently installed.)
Preparing to unpack .../libkrb5-3_1.19.2-2ubuntu0.6_amd64.deb ...
Unpacking libkrb5-3:amd64 (1.19.2-2ubuntu0.6) over (1.19.2-2ubuntu0.5) ...
Setting up libkrb5-3:amd64 (1.19.2-2ubuntu0.6) ...
(Reading database ... 14136 files and directories currently installed.)
Preparing to unpack .../libgssapi-krb5-2_1.19.2-2ubuntu0.6_amd64.deb ...
Unpacking libgssapi-krb5-2:amd64 (1.19.2-2ubuntu0.6) over (1.19.2-2ubuntu0.5) ...
Setting up libgssapi-krb5-2:amd64 (1.19.2-2ubuntu0.6) ...
Processing triggers for libc-bin (2.35-0ubuntu3.9) ...

root in ~ on Baker_Street_Linux_Server>
```

### Create the package_list.txt to Display All Currently-Installed Packages
```bash
root in ~ on Baker_Street_Linux_Server>  apt list --installed
Listing... Done
adduser/jammy,now 3.118ubuntu5 all [installed]
apt/jammy-updates,now 2.4.13 amd64 [installed]
base-files/jammy-updates,now 12ubuntu4.7 amd64 [installed]
base-passwd/jammy,now 3.5.52build1 amd64 [installed]
bash/jammy-updates,jammy-security,now 5.1-6ubuntu1.1 amd64 [installed]
bsdutils/jammy-updates,jammy-security,now 1:2.37.2-4ubuntu3.4 amd64 [installed]
ca-certificates/jammy-updates,jammy-security,now 20240203~22.04.1 all [installed,automatic]
coreutils/jammy-updates,now 8.32-4.1ubuntu1.2 amd64 [installed]
cpio/jammy-updates,jammy-security,now 2.13+dfsg-7ubuntu0.1 amd64 [installed,automatic]
cron/jammy,now 3.0pl1-137ubuntu3 amd64 [installed,automatic]
curl/jammy-updates,jammy-security,now 7.81.0-1ubuntu1.20 amd64 [installed]
dash/jammy,now 0.5.11+git20210903+057cd650a4ed-3build1 amd64 [installed]
dbus/jammy-updates,jammy-security,now 1.12.20-2ubuntu4.1 amd64 [installed,automatic]
debconf/jammy,now 1.5.79ubuntu1 all [installed]
debianutils/jammy,now 5.5-1ubuntu2 amd64 [installed]
diffutils/jammy,now 1:3.8-0ubuntu2 amd64 [installed]
distro-info-data/jammy-updates,now 0.52ubuntu0.8 all [installed,automatic]
dmsetup/jammy-updates,now 2:1.02.175-2.1ubuntu5 amd64 [installed,automatic]
dpkg/jammy-updates,now 1.21.1ubuntu2.3 amd64 [installed]
e2fsprogs/jammy-updates,now 1.46.5-2ubuntu1.2 amd64 [installed]
findutils/jammy,now 4.8.0-1ubuntu3 amd64 [installed]
gcc-12-base/jammy-updates,jammy-security,now 12.3.0-1ubuntu1~22.04 amd64 [installed]
gir1.2-glib-2.0/jammy,now 1.72.0-1 amd64 [installed,automatic]
gpgv/jammy-updates,jammy-security,now 2.2.27-3ubuntu2.1 amd64 [installed]
grep/jammy,now 3.7-1build1 amd64 [installed]
gzip/jammy-updates,now 1.10-4ubuntu4.1 amd64 [installed]
hostname/jammy,now 3.23ubuntu2 amd64 [installed]
init-system-helpers/jammy,now 1.62 all [installed]
iproute2/jammy,now 5.15.0-1ubuntu2 amd64 [installed]
iptables/jammy-updates,now 1.8.7-1ubuntu5.2 amd64 [installed,automatic]
john-data/jammy,now 1.8.0-4ubuntu3 all [installed,automatic]
john/jammy,now 1.8.0-4ubuntu3 amd64 [installed]
libacl1/jammy,now 2.3.1-1 amd64 [installed]
libapparmor1/jammy-updates,jammy-security,now 3.0.4-2ubuntu2.4 amd64 [installed,automatic]
libapt-pkg6.0/jammy-updates,now 2.4.13 amd64 [installed]
libargon2-1/jammy,now 0~20171227-0.3 amd64 [installed,automatic]
libatm1/jammy,now 1:2.5.1-4build2 amd64 [installed,automatic]
libattr1/jammy,now 1:2.5.1-1build1 amd64 [installed]
libaudit-common/jammy,now 1:3.0.7-1build1 all [installed]
libaudit1/jammy,now 1:3.0.7-1build1 amd64 [installed]
libblkid1/jammy-updates,jammy-security,now 2.37.2-4ubuntu3.4 amd64 [installed]
libbpf0/jammy-updates,jammy-security,now 1:0.5.0-1ubuntu22.04.1 amd64 [installed,automatic]
libbrotli1/jammy,now 1.0.9-2build6 amd64 [installed,automatic]
libbsd0/jammy,now 0.11.5-1 amd64 [installed,automatic]
libbz2-1.0/jammy,now 1.0.8-5build1 amd64 [installed]
libc-bin/jammy-updates,jammy-security,now 2.35-0ubuntu3.9 amd64 [installed]
libc6/jammy-updates,jammy-security,now 2.35-0ubuntu3.9 amd64 [installed]
libcap-ng0/jammy,now 0.7.9-2.2build3 amd64 [installed]
libcap2-bin/jammy-updates,jammy-security,now 1:2.44-1ubuntu0.22.04.2 amd64 [installed,automatic]
libcap2/jammy-updates,jammy-security,now 1:2.44-1ubuntu0.22.04.2 amd64 [installed]
libcbor0.8/jammy,now 0.8.0-2ubuntu1 amd64 [installed,automatic]
libcom-err2/jammy-updates,now 1.46.5-2ubuntu1.2 amd64 [installed]
libcrypt1/jammy,now 1:4.4.27-1 amd64 [installed]
libcryptsetup12/jammy-updates,now 2:2.4.3-1ubuntu1.2 amd64 [installed,automatic]
libcurl4/jammy-updates,jammy-security,now 7.81.0-1ubuntu1.20 amd64 [installed,automatic]
libdb5.3/jammy,now 5.3.28+dfsg1-0.8ubuntu3 amd64 [installed]
libdbus-1-3/jammy-updates,jammy-security,now 1.12.20-2ubuntu4.1 amd64 [installed,automatic]
libdebconfclient0/jammy,now 0.261ubuntu1 amd64 [installed]
libdevmapper1.02.1/jammy-updates,now 2:1.02.175-2.1ubuntu5 amd64 [installed,automatic]
libedit2/jammy,now 3.1-20210910-1build1 amd64 [installed,automatic]
libelf1/jammy,now 0.186-1build1 amd64 [installed,automatic]
libestr0/jammy,now 0.1.10-2.1build3 amd64 [installed,automatic]
libevent-2.1-7/jammy,now 2.1.12-stable-1build3 amd64 [installed,automatic]
libexpat1/jammy-updates,jammy-security,now 2.4.7-1ubuntu0.5 amd64 [installed,automatic]
libext2fs2/jammy-updates,now 1.46.5-2ubuntu1.2 amd64 [installed]
libfastjson4/jammy,now 0.99.9-1build2 amd64 [installed,automatic]
libffi8/jammy,now 3.4.2-4 amd64 [installed]
libfido2-1/jammy,now 1.10.0-1 amd64 [installed,automatic]
libgcc-s1/jammy-updates,jammy-security,now 12.3.0-1ubuntu1~22.04 amd64 [installed]
libgcrypt20/jammy,now 1.9.4-3ubuntu3 amd64 [installed]
libgdbm-compat4/jammy,now 1.23-1 amd64 [installed,automatic]
libgdbm6/jammy,now 1.23-1 amd64 [installed,automatic]
libgirepository-1.0-1/jammy,now 1.72.0-1 amd64 [installed,automatic]
libglib2.0-0/jammy-updates,jammy-security,now 2.72.4-0ubuntu2.4 amd64 [installed,automatic]
libglib2.0-data/jammy-updates,jammy-security,now 2.72.4-0ubuntu2.4 all [installed,automatic]
libgmp10/jammy,now 2:6.2.1+dfsg-3ubuntu1 amd64 [installed]
libgnutls30/jammy-updates,jammy-security,now 3.7.3-4ubuntu1.6 amd64 [installed]
libgomp1/jammy-updates,jammy-security,now 12.3.0-1ubuntu1~22.04 amd64 [installed,automatic]
libgpg-error0/jammy,now 1.43-3 amd64 [installed]
libgssapi-krb5-2/jammy-updates,jammy-security,now 1.19.2-2ubuntu0.6 amd64 [installed]
libhogweed6/jammy,now 3.7.3-1build2 amd64 [installed]
libicu70/jammy,now 70.1-2 amd64 [installed,automatic]
libidn2-0/jammy,now 2.3.2-2build1 amd64 [installed]
libip4tc2/jammy-updates,now 1.8.7-1ubuntu5.2 amd64 [installed,automatic]
libip6tc2/jammy-updates,now 1.8.7-1ubuntu5.2 amd64 [installed,automatic]
libjson-c5/jammy-updates,jammy-security,now 0.15-3~ubuntu1.22.04.2 amd64 [installed,automatic]
libk5crypto3/jammy-updates,jammy-security,now 1.19.2-2ubuntu0.6 amd64 [installed]
libkeyutils1/jammy,now 1.6.1-2ubuntu3 amd64 [installed]
libkmod2/jammy,now 29-1ubuntu1 amd64 [installed,automatic]
libkrb5-3/jammy-updates,jammy-security,now 1.19.2-2ubuntu0.6 amd64 [installed]
libkrb5support0/jammy-updates,jammy-security,now 1.19.2-2ubuntu0.6 amd64 [installed]
libldap-2.5-0/jammy-updates,now 2.5.18+dfsg-0ubuntu0.22.04.3 amd64 [installed,automatic]
libldap-common/jammy-updates,now 2.5.18+dfsg-0ubuntu0.22.04.3 all [installed,automatic]
liblz4-1/jammy,now 1.9.3-2build2 amd64 [installed]
liblzma5/jammy,now 5.2.5-2ubuntu1 amd64 [installed]
libmd0/jammy,now 1.0.4-1build1 amd64 [installed,automatic]
libmnl0/jammy,now 1.0.4-3build2 amd64 [installed,automatic]
libmount1/jammy-updates,jammy-security,now 2.37.2-4ubuntu3.4 amd64 [installed]
libmpdec3/jammy,now 2.5.1-2build2 amd64 [installed,automatic]
libncurses6/jammy-updates,jammy-security,now 6.3-2ubuntu0.1 amd64 [installed]
libncursesw6/jammy-updates,jammy-security,now 6.3-2ubuntu0.1 amd64 [installed]
libnetfilter-conntrack3/jammy,now 1.0.9-1 amd64 [installed,automatic]
libnettle8/jammy,now 3.7.3-1build2 amd64 [installed]
libnfnetlink0/jammy,now 1.0.1-3build3 amd64 [installed,automatic]
libnftnl11/jammy,now 1.2.1-1build1 amd64 [installed,automatic]
libnghttp2-14/jammy-updates,jammy-security,now 1.43.0-1ubuntu0.2 amd64 [installed,automatic]
libnsl2/jammy,now 1.3.0-2build2 amd64 [installed]
libnss-systemd/jammy-updates,now 249.11-0ubuntu3.12 amd64 [installed,automatic]
libp11-kit0/jammy,now 0.24.0-6build1 amd64 [installed]
libpam-cap/jammy-updates,jammy-security,now 1:2.44-1ubuntu0.22.04.2 amd64 [installed,automatic]
libpam-modules-bin/jammy-updates,now 1.4.0-11ubuntu2.5 amd64 [installed]
libpam-modules/jammy-updates,now 1.4.0-11ubuntu2.5 amd64 [installed]
libpam-runtime/jammy-updates,now 1.4.0-11ubuntu2.5 all [installed]
libpam-systemd/jammy-updates,now 249.11-0ubuntu3.12 amd64 [installed,automatic]
libpam0g/jammy-updates,now 1.4.0-11ubuntu2.5 amd64 [installed]
libpcre2-8-0/jammy-updates,jammy-security,now 10.39-3ubuntu0.1 amd64 [installed]
libpcre3/jammy-updates,jammy-security,now 2:8.39-13ubuntu0.22.04.1 amd64 [installed]
libperl5.34/jammy-updates,jammy-security,now 5.34.0-3ubuntu1.3 amd64 [installed,automatic]
libpopt0/jammy,now 1.18-3build1 amd64 [installed,automatic]
libprocps8/jammy-updates,jammy-security,now 2:3.3.17-6ubuntu2.1 amd64 [installed]
libpsl5/jammy,now 0.21.0-1.2build2 amd64 [installed,automatic]
libpython3-stdlib/jammy-updates,now 3.10.6-1~22.04.1 amd64 [installed,automatic]
libpython3.10-minimal/jammy-updates,jammy-security,now 3.10.12-1~22.04.9 amd64 [installed,automatic]
libpython3.10-stdlib/jammy-updates,jammy-security,now 3.10.12-1~22.04.9 amd64 [installed,automatic]
libreadline8/jammy,now 8.1.2-1 amd64 [installed,automatic]
librtmp1/jammy,now 2.4+20151223.gitfa8646d.1-2build4 amd64 [installed,automatic]
libsasl2-2/jammy-updates,now 2.1.27+dfsg2-3ubuntu1.2 amd64 [installed,automatic]
libsasl2-modules-db/jammy-updates,now 2.1.27+dfsg2-3ubuntu1.2 amd64 [installed,automatic]
libsasl2-modules/jammy-updates,now 2.1.27+dfsg2-3ubuntu1.2 amd64 [installed,automatic]
libseccomp2/jammy-updates,now 2.5.3-2ubuntu3~22.04.1 amd64 [installed]
libselinux1/jammy,now 3.3-1build2 amd64 [installed]
libsemanage-common/jammy,now 3.3-1build2 all [installed]
libsemanage2/jammy,now 3.3-1build2 amd64 [installed]
libsepol2/jammy,now 3.3-1build1 amd64 [installed]
libsmartcols1/jammy-updates,jammy-security,now 2.37.2-4ubuntu3.4 amd64 [installed]
libsqlite3-0/jammy-updates,jammy-security,now 3.37.2-2ubuntu0.3 amd64 [installed,automatic]
libss2/jammy-updates,now 1.46.5-2ubuntu1.2 amd64 [installed]
libssh-4/jammy-updates,jammy-security,now 0.9.6-2ubuntu0.22.04.3 amd64 [installed,automatic]
libssl3/jammy-updates,jammy-security,now 3.0.2-0ubuntu1.19 amd64 [installed]
libstdc++6/jammy-updates,jammy-security,now 12.3.0-1ubuntu1~22.04 amd64 [installed]
libsystemd0/jammy-updates,now 249.11-0ubuntu3.12 amd64 [installed]
libtasn1-6/jammy-updates,jammy-security,now 4.18.0-4ubuntu0.1 amd64 [installed]
libtinfo6/jammy-updates,jammy-security,now 6.3-2ubuntu0.1 amd64 [installed]
libtirpc-common/jammy-updates,jammy-security,now 1.3.2-2ubuntu0.1 all [installed]
libtirpc3/jammy-updates,jammy-security,now 1.3.2-2ubuntu0.1 amd64 [installed]
libudev1/jammy-updates,now 249.11-0ubuntu3.12 amd64 [installed]
libunistring2/jammy,now 1.0-1 amd64 [installed]
libuuid1/jammy-updates,jammy-security,now 2.37.2-4ubuntu3.4 amd64 [installed]
libwrap0/jammy,now 7.6.q-31build2 amd64 [installed,automatic]
libx11-6/jammy-updates,jammy-security,now 2:1.7.5-1ubuntu0.3 amd64 [installed,automatic]
libx11-data/jammy-updates,jammy-security,now 2:1.7.5-1ubuntu0.3 all [installed,automatic]
libxau6/jammy,now 1:1.0.9-1build5 amd64 [installed,automatic]
libxcb1/jammy,now 1.14-3ubuntu3 amd64 [installed,automatic]
libxdmcp6/jammy,now 1:1.1.3-0ubuntu5 amd64 [installed,automatic]
libxext6/jammy,now 2:1.3.4-1build1 amd64 [installed,automatic]
libxml2/jammy-updates,jammy-security,now 2.9.13+dfsg-1ubuntu0.6 amd64 [installed,automatic]
libxmuu1/jammy,now 2:1.1.3-3 amd64 [installed,automatic]
libxtables12/jammy-updates,now 1.8.7-1ubuntu5.2 amd64 [installed,automatic]
libxxhash0/jammy,now 0.8.1-1 amd64 [installed]
libzstd1/jammy,now 1.4.8+dfsg-3build1 amd64 [installed]
login/jammy-updates,jammy-security,now 1:4.8.1-2ubuntu2.2 amd64 [installed]
logrotate/jammy-updates,jammy-security,now 3.19.0-1ubuntu1.1 amd64 [installed,automatic]
logsave/jammy-updates,now 1.46.5-2ubuntu1.2 amd64 [installed]
lsb-base/jammy,now 11.1.0ubuntu4 all [installed]
lsb-release/jammy,now 11.1.0ubuntu4 all [installed,automatic]
lynis/jammy,now 3.0.7-1 all [installed]
mawk/jammy,now 1.3.4.20200120-3 amd64 [installed]
media-types/jammy,now 7.0.0 all [installed,automatic]
menu/jammy,now 2.1.47ubuntu4 amd64 [installed,automatic]
mount/jammy-updates,jammy-security,now 2.37.2-4ubuntu3.4 amd64 [installed]
nano/jammy-updates,jammy-security,now 6.2-1ubuntu0.1 amd64 [installed]
ncurses-base/jammy-updates,jammy-security,now 6.3-2ubuntu0.1 all [installed]
ncurses-bin/jammy-updates,jammy-security,now 6.3-2ubuntu0.1 amd64 [installed]
ncurses-term/jammy-updates,jammy-security,now 6.3-2ubuntu0.1 all [installed,automatic]
net-tools/jammy,now 1.60+git20181103.0eebece-1ubuntu5 amd64 [installed]
netbase/jammy,now 6.3 all [installed,automatic]
networkd-dispatcher/jammy-updates,jammy-security,now 2.1-2ubuntu0.22.04.2 all [installed,automatic]
openbsd-inetd/jammy,now 0.20160825-5 amd64 [installed,automatic]
openssh-client/jammy-updates,jammy-security,now 1:8.9p1-3ubuntu0.11 amd64 [installed,automatic]
openssh-server/jammy-updates,jammy-security,now 1:8.9p1-3ubuntu0.11 amd64 [installed]
openssh-sftp-server/jammy-updates,jammy-security,now 1:8.9p1-3ubuntu0.11 amd64 [installed,automatic]
openssl/jammy-updates,jammy-security,now 3.0.2-0ubuntu1.19 amd64 [installed]
passwd/jammy-updates,jammy-security,now 1:4.8.1-2ubuntu2.2 amd64 [installed]
perl-base/jammy-updates,jammy-security,now 5.34.0-3ubuntu1.3 amd64 [installed]
perl-modules-5.34/jammy-updates,jammy-security,now 5.34.0-3ubuntu1.3 all [installed,automatic]
perl/jammy-updates,jammy-security,now 5.34.0-3ubuntu1.3 amd64 [installed,automatic]
postfix/jammy-updates,jammy-security,now 3.6.4-1ubuntu1.3 amd64 [installed,automatic]
procps/jammy-updates,jammy-security,now 2:3.3.17-6ubuntu2.1 amd64 [installed]
psmisc/jammy,now 23.4-2build3 amd64 [installed,automatic]
publicsuffix/jammy,now 20211207.1025-1 all [installed,automatic]
python3-dbus/jammy,now 1.2.18-3build1 amd64 [installed,automatic]
python3-distro/jammy,now 1.7.0-1 all [installed,automatic]
python3-gi/jammy-updates,now 3.42.1-0ubuntu1 amd64 [installed,automatic]
python3-minimal/jammy-updates,now 3.10.6-1~22.04.1 amd64 [installed,automatic]
python3.10-minimal/jammy-updates,jammy-security,now 3.10.12-1~22.04.9 amd64 [installed,automatic]
python3.10/jammy-updates,jammy-security,now 3.10.12-1~22.04.9 amd64 [installed,automatic]
python3/jammy-updates,now 3.10.6-1~22.04.1 amd64 [installed,automatic]
readline-common/jammy,now 8.1.2-1 all [installed,automatic]
rsh-server/jammy,now 0.17-22 amd64 [installed]
rsyslog/jammy-updates,jammy-security,now 8.2112.0-2ubuntu2.2 amd64 [installed]
sed/jammy,now 4.8-1ubuntu2 amd64 [installed]
sensible-utils/jammy,now 0.0.17 all [installed]
shared-mime-info/jammy,now 2.1-2 amd64 [installed,automatic]
ssh-import-id/jammy,now 5.11-0ubuntu1 all [installed,automatic]
ssl-cert/jammy,now 1.1.2 all [installed,automatic]
sudo/jammy-updates,jammy-security,now 1.9.9-1ubuntu2.4 amd64 [installed]
systemd-sysv/jammy-updates,now 249.11-0ubuntu3.12 amd64 [installed,automatic]
systemd-timesyncd/jammy-updates,now 249.11-0ubuntu3.12 amd64 [installed,automatic]
systemd/jammy-updates,now 249.11-0ubuntu3.12 amd64 [installed,automatic]
sysvinit-utils/jammy,now 3.01-1ubuntu1 amd64 [installed]
tar/jammy-updates,jammy-security,now 1.34+dfsg-1ubuntu0.1.22.04.2 amd64 [installed]
tcpd/jammy,now 7.6.q-31build2 amd64 [installed,automatic]
tree/jammy,now 2.0.2-1 amd64 [installed]
tripwire/jammy,now 2.4.3.7-4 amd64 [installed]
ubuntu-keyring/jammy,now 2021.03.26 all [installed]
ucf/jammy,now 3.0043 all [installed,automatic]
ufw/jammy-updates,now 0.36.1-4ubuntu0.1 all [installed]
update-inetd/jammy,now 4.51 all [installed,automatic]
usrmerge/jammy,now 25ubuntu2 all [installed]
util-linux/jammy-updates,jammy-security,now 2.37.2-4ubuntu3.4 amd64 [installed]
wget/jammy-updates,jammy-security,now 1.21.2-2ubuntu1.1 amd64 [installed,automatic]
xauth/jammy,now 1:1.1-1build2 amd64 [installed,automatic]
xdg-user-dirs/jammy,now 0.17-2ubuntu4 amd64 [installed,automatic]
zlib1g/jammy-updates,jammy-security,now 1:1.2.11.dfsg-2ubuntu9.2 amd64 [installed]

root in ~ on Baker_Street_Linux_Server>  dpkg --get-selections
adduser                         install
apt                             install
base-files                      install
base-passwd                     install
bash                            install
bsdutils                        install
ca-certificates                 install
coreutils                       install
cpio                            install
cron                            install
curl                            install
dash                            install
dbus                            install
debconf                         install
debianutils                     install
diffutils                       install
dirmngr                         deinstall
distro-info-data                install
dmsetup                         install
dpkg                            install
e2fsprogs                       install
findutils                       install
gcc-12-base:amd64               install
gir1.2-glib-2.0:amd64           install
gpg-agent                       deinstall
gpgv                            install
grep                            install
gzip                            install
hostname                        install
ibverbs-providers:amd64         deinstall
init-system-helpers             install
iproute2                        install
iptables                        install
john                            install
john-data                       install
libacl1:amd64                   install
libapparmor1:amd64              install
libapt-pkg6.0:amd64             install
libargon2-1:amd64               install
libatm1:amd64                   install
libattr1:amd64                  install
libaudit-common                 install
libaudit1:amd64                 install
libblkid1:amd64                 install
libbpf0:amd64                   install
libbrotli1:amd64                install
libbsd0:amd64                   install
libbz2-1.0:amd64                install
libc-bin                        install
libc6:amd64                     install
libcap-ng0:amd64                install
libcap2:amd64                   install
libcap2-bin                     install
libcbor0.8:amd64                install
libcom-err2:amd64               install
libcrypt1:amd64                 install
libcryptsetup12:amd64           install
libcurl4:amd64                  install
libdb5.3:amd64                  install
libdbus-1-3:amd64               install
libdebconfclient0:amd64         install
libdevmapper1.02.1:amd64        install
libedit2:amd64                  install
libelf1:amd64                   install
libestr0:amd64                  install
libevent-2.1-7:amd64            install
libexpat1:amd64                 install
libext2fs2:amd64                install
libfastjson4:amd64              install
libffi8:amd64                   install
libfido2-1:amd64                install
libgcc-s1:amd64                 install
libgcrypt20:amd64               install
libgdbm-compat4:amd64           install
libgdbm6:amd64                  install
libgirepository-1.0-1:amd64     install
libglib2.0-0:amd64              install
libglib2.0-data                 install
libgmp10:amd64                  install
libgnutls30:amd64               install
libgomp1:amd64                  install
libgpg-error0:amd64             install
libgssapi-krb5-2:amd64          install
libhogweed6:amd64               install
libicu70:amd64                  install
libidn2-0:amd64                 install
libip4tc2:amd64                 install
libip6tc2:amd64                 install
libjson-c5:amd64                install
libk5crypto3:amd64              install
libkeyutils1:amd64              install
libkmod2:amd64                  install
libkrb5-3:amd64                 install
libkrb5support0:amd64           install
libldap-2.5-0:amd64             install
libldap-common                  install
liblz4-1:amd64                  install
liblzma5:amd64                  install
libmd0:amd64                    install
libmecab2:amd64                 deinstall
libmnl0:amd64                   install
libmount1:amd64                 install
libmpdec3:amd64                 install
libncurses6:amd64               install
libncursesw6:amd64              install
libnetfilter-conntrack3:amd64   install
libnettle8:amd64                install
libnfnetlink0:amd64             install
libnftnl11:amd64                install
libnghttp2-14:amd64             install
libnl-3-200:amd64               deinstall
libnsl2:amd64                   install
libnss-systemd:amd64            install
libp11-kit0:amd64               install
libpam-cap:amd64                install
libpam-modules:amd64            install
libpam-modules-bin              install
libpam-runtime                  install
libpam-systemd:amd64            install
libpam0g:amd64                  install
libpcre2-8-0:amd64              install
libpcre3:amd64                  install
libperl5.34:amd64               install
libpopt0:amd64                  install
libprocps8:amd64                install
libpsl5:amd64                   install
libpython3-stdlib:amd64         install
libpython3.10-minimal:amd64     install
libpython3.10-stdlib:amd64      install
libreadline8:amd64              install
librtmp1:amd64                  install
libsasl2-2:amd64                install
libsasl2-modules:amd64          install
libsasl2-modules-db:amd64       install
libseccomp2:amd64               install
libselinux1:amd64               install
libsemanage-common              install
libsemanage2:amd64              install
libsepol2:amd64                 install
libsmartcols1:amd64             install
libsqlite3-0:amd64              install
libss2:amd64                    install
libssh-4:amd64                  install
libssl3:amd64                   install
libstdc++6:amd64                install
libsystemd0:amd64               install
libtasn1-6:amd64                install
libtinfo6:amd64                 install
libtirpc-common                 install
libtirpc3:amd64                 install
libudev1:amd64                  install
libunistring2:amd64             install
libuuid1:amd64                  install
libwrap0:amd64                  install
libx11-6:amd64                  install
libx11-data                     install
libxau6:amd64                   install
libxcb1:amd64                   install
libxdmcp6:amd64                 install
libxext6:amd64                  install
libxml2:amd64                   install
libxmuu1:amd64                  install
libxtables12:amd64              install
libxxhash0:amd64                install
libzstd1:amd64                  install
login                           install
logrotate                       install
logsave                         install
lsb-base                        install
lsb-release                     install
lynis                           install
mawk                            install
media-types                     install
menu                            install
mount                           install
nano                            install
ncurses-base                    install
ncurses-bin                     install
ncurses-term                    install
net-tools                       install
netbase                         install
networkd-dispatcher             install
openbsd-inetd                   install
openssh-client                  install
openssh-server                  install
openssh-sftp-server             install
openssl                         install
passwd                          install
perl                            install
perl-base                       install
perl-modules-5.34               install
postfix                         install
procps                          install
psmisc                          install
publicsuffix                    install
python3                         install
python3-dbus                    install
python3-distro                  install
python3-gi                      install
python3-minimal                 install
python3.10                      install
python3.10-minimal              install
readline-common                 install
rsh-server                      install
rsyslog                         install
sed                             install
sensible-utils                  install
shared-mime-info                install
ssh-import-id                   install
ssl-cert                        install
sudo                            install
systemd                         install
systemd-sysv                    install
systemd-timesyncd               install
sysvinit-utils                  install
tar                             install
tcpd                            install
telnet                          deinstall
tree                            install
tripwire                        install
ubuntu-keyring                  install
ucf                             install
ufw                             install
update-inetd                    install
usrmerge                        install
util-linux                      install
wget                            install
xauth                           install
xdg-user-dirs                   install
zlib1g:amd64                    install

# To run either of these commands and have their output echoed to package_list.txt
# run the following:
root in ~ on Baker_Street_Linux_Server>  apt list --installed > package_list.txt
# or 
root in ~ on Baker_Street_Linux_Server>  dpkg --get-selections > package_list.txt

# This will create a package_list.txt file in the current directory, which
# contains the output of the command.
# Perhaps it's even better to know the date that the command was run, which
# will show ya the packages listed on that date (a little more info when you
# look back at this file in the future)
root in ~ on Baker_Street_Linux_Server>  dpkg --get-selections > "package_list_$(date +%F).txt"
```

### Remove the following packages: telnet, rsh-client
```bash
root in ~ on Baker_Street_Linux_Server> cat package_list.txt | grep 'telnet'
telnet/jammy,now 0.17-44build1 amd64 [installed]

root in ~ on Baker_Street_Linux_Server> cat package_list.txt | grep 'rsh'
rsh-client/jammy,now 0.17-22 amd64 [installed]
rsh-server/jammy,now 0.17-22 amd64 [installed]

# Alternatively, you can use the following command to not have to rely on the 
# recency/updatedness of your package_list.txt
root in ~ on Baker_Street_Linux_Server> dpkg --get-selections | awk '{print $1, $2}' | grep -E 'telnet|rsh'
telnet     install
rsh-client install
rsh-server install

# If you want to fully remove a package in one step (including configuration files):
root in ~ on Baker_Street_Linux_Server>  apt purge -y telnet rsh-client

# If you want to remove a package in one step (keeping configuration files):
root in ~ on Baker_Street_Linux_Server>  apt remove -y telnet rsh-client

# Then, once one of these commnds is run, remove any dependencies:
root in ~ on Baker_Street_Linux_Server>  apt autoremove -y

# Note: from a security analyst perspective, it might be good to keep configuration
# files for these packages, so you can later review if they were modified to use
# uncommon ports, move logs, stop logging, run as suspect users, etc.
```

### Add the following packages: ufw, lynis, tripwire
#### Install Security Hardening Tools
```bash
root in ~ on Baker_Street_Linux_Server>  apt install -y ufw lynis tripwire
```


### Research and Document Hardening Features
After installation, document the security enhancements provided by each tool:
  - **UFW (Uncomplicated Firewall)** → Simplifies firewall management and enforces network security policies.
  - **Lynis** → Performs in-depth security audits, detecting misconfigurations and vulnerabilities.
  - **Tripwire** → Monitors system files and directories for unauthorized changes, aiding in intrusion detection.

<br>

## Day 2 Part 3: Disabling Unnecessary Services
Reducing the number of running services minimizes the attack surface. Let's identify and disable any unnecessary ones.

### **Step 1: List All Services & Save to a File**
Since `systemctl` isn't available, use the `service` command:

```bash
service --status-all > service_list.txt
```

Check the saved list:
```bash
root in ~ on Baker_Street_Linux_Server> cat service_list.txt
 [ - ]  cron
 [ - ]  dbus
 [ + ]  nmbd
 [ - ]  openbsd-inetd
 [ - ]  postfix
 [ - ]  procps
 [ - ]  samba-ad-dc
 [ + ]  smbd
 [ - ]  ssh
 [ - ]  ufw
```

### **Step 2: Check if mysql or samba Is Running**
```bash
service --status-all | grep -E "mysql|samba"
 [ ? ]  hwclock.sh
 [ - ]  samba-ad-dc
 [ + ]  mysql
 ```

### **Step 3: Stop & Disable Unnecessary Services**

**i. Stop the Services (If Running)**

If MySQL or Samba is running, stop them:
```bash
service mysql stop
service mysql status

service smbd stop  # For Samba
service smbd status
service nmbd stop  # Samba NetBIOS Name Service
service nmbd status
```


**ii. Disable the Services to Prevent Startup**
```bash
update-rc.d mysql disable
update-rc.d smbd disable
update-rc.d nmbd disable
```

### **Step 4: Remove Unnecessary Services**

If MySQL or Samba is **not needed**, remove them completely:
```bash
apt remove --purge -y mysql-server samba samba-common
apt autoremove -y
apt autoclean -y
```

For a **full MySQL removal**, including config files and logs:
```bash
apt remove --purge -y mysql-server mysql-client mysql-common mysql-server-core-* mysql-client-core-*
rm -rf /etc/mysql /var/lib/mysql /var/log/mysql
apt autoremove -y
apt autoclean -y
```

### **Step 5: Verify Services are Goners, Blazammed, Removed**
```bash
service --status-all | grep -E "mysql|samba"
```

If nothing appears, **they're completely removed and you are gravy!**

<br>

## Day 2 Part 4: Enabling and Configuring Logging

Logging is crucial for monitoring security incidents. Let's configure persistent logs and log rotation to ensure logs are stored effectively while preventing excessive disk usage.

### **Step 1: Enable Persistent Logging (`journald.conf`)**

Make a backup of the journald.conf file before editing:
```bash
cp /etc/systemd/journald.conf /etc/systemd/journald.conf.broen
```

**Edit the configuration file**

Open the file in **Nano**:
```bash
nano /etc/systemd/journald.conf
```

Use **Ctrl + W** to search for:
  -  Storage=auto (or simply "Storage")
  -  #SystemMaxUse= (or simply, "SystemMaxUse")

**Modify the following lines**

Uncomment (remove #) and set the values:

```bash
# Set storage to persistent to keep logs across reboots
Storage=persistent
# Set maximum use of system logs
SystemMaxUse=300M
```

Save and exit (**Ctrl + x**, then **y**, then **Enter**).

<hr>

### **Step 2: Restart systemd-journald to Apply Changes**

Since systemctl isn't available, restart manually:
```bash
service systemd-journald restart
```

<hr>

### **Step 3: Verify Logs are Now Persistent**

Check if logs are being stored persistently:
```bash
# Verify the journal integrity
journalctl --verify
# Check disk usage of the journal
journalctl --disk-usage
```

<hr>

### **Step 4: Configure Log Rotation (`logrotate.conf`)**

og rotation prevents logs from growing indefinitely, reducing disk space usage.

**Open the log rotation configuration file:**

```bash
nano /etc/logrotate.conf
```

**Modify the following settings**

#### Change log rotation from weekly to daily

Find:
```bash
# rotate log files weekly
weekly
```

Replace with:
```bash
# rotate log files weekly --> now daily
daily
```

#### Adjust log retention to 7 days

Find:
```bash
# keep 4 weeks worth of backlogs
rotate 4
```

Replace with:
```bash
# keep 7 days worth of backlogs (previously 4 weeks)
rotate 7
```

Save and exit (**Ctrl + x**, then **y**, then **Enter**).

<hr>

### **Step 5: Verify Log Rotation is Active**

Test the log rotation configuration:

```bash
logrotate -d /etc/logrotate.conf
```

Notes:
  - -d **(debug mode)** runs a **dry test** without actually rotating logs.
  - If no errors appear, your setup is correct, and you are good (they may one day call you great, even).

<br>

## Day 3 Part 1: Scripting the Hardening Tasks

Script 1
  - View and copy the template
  - Update the script everywhere you see placeholders in red
  - Copy the new script into a file called **hardening_script_1.sh**
  - Update the new script's permissions and run it to validate there are no errors

```bash
#!/bin/bash

# Variable for the report output file, choose an output file name
REPORT_FILE="$(pwd)/hardening_script_1_report_$(date +%F-%H-%M-%S).txt"  # Use the current directory and timestamp for the report

# Output the hostname
echo "Gathering hostname..."
echo "Hostname: $(hostname)" >> $REPORT_FILE
printf "\n" >> $REPORT_FILE

# Output the OS version
echo "Gathering OS version..."
echo "OS Version: $(lsb_release -a | grep 'Description' | cut -f2)" >> $REPORT_FILE
printf "\n" >> $REPORT_FILE

# Output memory information
echo "Gathering memory information..."
echo "Memory Information: $(free -h)" >> $REPORT_FILE
printf "\n" >> $REPORT_FILE

# Output uptime information
echo "Gathering uptime information..."
echo "Uptime Information: $(uptime)" >> $REPORT_FILE
printf "\n" >> $REPORT_FILE

# Backup the OS
echo "Backing up the OS..."
# Example command for backing up using tar
#tar -czf /backup/os_backup_$(date +%F).tar.gz /etc /home /var
tar -cvpzf /root/baker_street_backup_$(date +%F).tar.gz --exclude=/root/baker_street_backup* --exclude=/proc --exclude=/tmp --exclude=/mnt --exclude=/sys --exclude=/dev --exclude=/run /
echo "OS backup completed." >> $REPORT_FILE
printf "\n" >> $REPORT_FILE

# Output the sudoers file to the report
echo "Gathering sudoers file..."
echo "Sudoers file: $(cat /etc/sudoers)" >> $REPORT_FILE
printf "\n" >> $REPORT_FILE

# Script to check for files with world permissions and update them
echo "Checking for files with world permissions..."
find /home -type f -perm -0002 -exec chmod o-w {} \;
echo "World permissions have been removed from any files found." >> $REPORT_FILE
printf "\n" >> $REPORT_FILE

# Find specific files and update their permissions
echo "Updating permissions for specific scripts..."

# Engineering scripts - Only members of the engineering group
echo "Updating permissions for Engineering scripts."
find / -iname '*engineering*' -exec chown :engineering {} + -exec chmod 770 {} + 2>/dev/null
echo "Permissions updated for Engineering scripts." >> $REPORT_FILE
printf "\n" >> $REPORT_FILE

# Research scripts - Only members of the research group
echo "Updating permissions for Research scripts..."
find / -iname '*research*' -exec chown :research {} + -exec chmod 770 {} + 2>/dev/null
echo "Permissions updated for Research scripts." >> $REPORT_FILE
printf "\n" >> $REPORT_FILE

# Finance scripts - Only members of the finance group
echo "Updating permissions for Finance scripts"
find / -iname '*finance*' -exec chown :finance {} + -exec chmod 770 {} + 2>/dev/null
echo "Permissions updated for Finance scripts." >> $REPORT_FILE
printf "\n" >> $REPORT_FILE

echo "Script execution completed. Check $REPORT_FILE for details."

```
  
Script 2
  - View and copy the template
  - Update the script everywhere you see placeholders in red
  - Copy the new script into a file called **hardening_script_2.sh**
  - Update the new script's permissions and run it to validate there are no errors

```bash
#!/bin/bash

# Variable for the report output file, choose a NEW output file name
REPORT_FILE="$(pwd)/hardening_script_2_report_$(date +%F-%H-%M-%S).txt"  # Use the current directory and timestamp for the report

# Output the sshd configuration file
echo "Gathering details from sshd configuration file"
# Display the contents of the sshd_config file
echo "sshd configuration file: $(cat /etc/ssh/sshd_config)" >> $REPORT_FILE
printf "\n" >> $REPORT_FILE

# Update packages and services
echo "Updating packages and services"
# Update the package list and upgrade installed packages
apt update && apt upgrade -y
echo "Packages have been updated and upgraded" >> $REPORT_FILE
printf "\n" >> $REPORT_FILE

# List all installed packages
echo "Installed Packages: $(dpkg --get-selections)" >> $REPORT_FILE
printf "\n" >> $REPORT_FILE

# Printing out logging configuration data
echo "Printing out logging configuration data"
# Output journald.conf data (systemd logging)
echo "journald.conf file data: $(cat /etc/systemd/journald.conf)" >> $REPORT_FILE
printf "\n" >> $REPORT_FILE

# Output logrotate configuration (for log management)
echo "logrotate.conf file data: $(cat /etc/logrotate.conf)" >> $REPORT_FILE
printf "\n" >> $REPORT_FILE

echo "Script execution completed. Check $REPORT_FILE for details."

```

<br>

## Day 3 Part 2: Scheduling the Hardening Scripts

Using cron:
  - Using cron, schedule `hardening_script_1` to: run once a month, on the first of the month
  - Using cron, schedule `hardening_script_2` to: run once a week, every Monday

To check that this is done, as root user:
```bash
crontab -e
```

It should show the following:
```bash
# Edit this file to introduce tasks to be run by cron.
#
# Each task to run has to be defined through a single line
# indicating with different fields when the task will be run
# and what command to run for the task
#
# To define the time you can provide concrete values for
# minute (m), hour (h), day of month (dom), month (mon),
# and day of week (dow) or use '*' in these fields (for 'any').
#
# Notice that tasks will be started based on the cron's system
# daemon's notion of time and timezones.
#
# Output of the crontab jobs (including errors) is sent through
# email to the user the crontab file belongs to (unless redirected).
#
# For example, you can run a backup of all your user accounts
# at 5 a.m every week with:
# 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/
#
# For more information see the manual pages of crontab(5) and cron(8)
#
# m h  dom mon dow   command

# Run at midnight on the first day of every month
0 0 1 * * /root/hardening_script_1.sh

# Run at midnight on every Monday
0 0 * * 1 /root/hardening_script_2.sh
```


<br>

## Summary: Vulnerabilities & Hardening Recommendations

Remember the scripts:
keepalive.sh
container_connect.sh
container_start.sh
source_this_file_it_is_for_bash_combined_aliases_and_functions_and_prompt (no suffix/file extension)





Thoughts on security:
Turn off password ssh and enforce keys

Don't maanage sudo access with sudoers file and sudoers group -- move them all to the group, that is what groups are for

Use ChatGPT to find any vulnerabilities with packages installed or kernel

To share scripts owned by different users within e.g. the research grouop, instead of changing all reasearch scripts in /home and subdirections to chown -R :research -- create a shared directory the machine and log who read/write/executed the file(s)

The cron jobs have potential security considations:
    -   The script runs as root, meaning it has high privileges.
    -   If the script is not properly secured, it could be a security risk (e.g., backdoor or persistence mechanism).
    -   Check what the script does, its permissions, and who has access to modify it.
    -   Review system logs (/var/log/syslog or /var/log/cron.log) to verify execution.
    -   The script is located in /root/, meaning it runs as root (high privilege).
    -   Check what hardening_script_1.sh does to ensure it's legitimate and secure.
    -   Review the script's permissions and logs to prevent unauthorized modifications.
    -   If this script was placed by an attacker, it might indicate persistence (backdoor).


Several security issues have been identified in the Linux kernel version 5.15.0-1077-aws. Notably, vulnerabilities in subsystems such as Netfilter, network traffic control, and VMware vSockets driver have been addressed.  ￼

Recommendations:
    1.  Update the Kernel:
    -   Ensure your system is running the latest kernel version available for Ubuntu 22.04.5 LTS. Regularly updating the kernel addresses known vulnerabilities and enhances system stability.
    2.  Review Installed Packages:
    -   Regularly check for updates to installed packages. Tools like apt can assist in identifying and applying necessary updates.
    3.  Enable Automatic Updates:
    -   Configure your system to automatically install security updates to promptly address newly discovered vulnerabilities.
    4.  Monitor Security Notices:
    -   Stay informed by regularly reviewing Ubuntu Security Notices for updates related to your system's packages.  ￼



our current kernel version, 5.15.0-1077-aws, may be susceptible to several vulnerabilities addressed in Ubuntu Security Notice USN-7021-5. These include issues in components such as GPU drivers, BTRFS, F2FS, GFS2 file systems, BPF subsystem, Netfilter, RxRPC session sockets, and the Integrity Measurement Architecture (IMA) framework. Notably, vulnerabilities like CVE-2024-27012 and CVE-2024-42228 have been identified.  

nstalled Packages:

A review of your installed packages reveals that some may have associated vulnerabilities:
    -   OpenVPN: Two vulnerabilities, CVE-2024-28882 and CVE-2024-5594, were discovered in OpenVPN, potentially allowing a remote authenticated client to keep the connection active or cause a denial of service.  

Recommendations:
    1.  Kernel Update: Consider updating your kernel to a version that addresses the identified vulnerabilities. Regularly check for and apply security patches provided by Ubuntu.
    2.  Package Updates: Ensure all installed packages are up-to-date. Regularly run sudo apt update and sudo apt upgrade to apply available security patches.
    3.  Security Notices: Stay informed by monitoring Ubuntu Security Notices for updates related to your system's packages.  ￼
    4.  Security Tools: Utilize security tools like Lynis for system audits and Tripwire for monitoring file integrity, as previously discussed.

Run Lynis (and other) auditing packages on the system

<details>
  <summary>Click to expand the results of the Lynis scan</summary>

```bash
root in ~ on Baker_Street_Linux_Server>  lynis audit system

[ Lynis 3.0.7 ]

################################################################################
  Lynis comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
  welcome to redistribute it under the terms of the GNU General Public License.
  See the LICENSE file for details about using this software.

  2007-2021, CISOfy - https://cisofy.com/lynis/
  Enterprise support available (compliance, plugins, interface and tools)
################################################################################


[+] Initializing program
------------------------------------
  - Detecting OS...                                           [ DONE ]
  - Checking profiles...                                      [ DONE ]

  ---------------------------------------------------
  Program version:           3.0.7
  Operating system:          Linux
  Operating system name:     Ubuntu
  Operating system version:  22.04
  Kernel version:            5.15.0
  Hardware platform:         x86_64
  Hostname:                  Baker_Street_Linux_Server
  ---------------------------------------------------
  Profiles:                  /etc/lynis/default.prf
  Log file:                  /var/log/lynis.log
  Report file:               /var/log/lynis-report.dat
  Report version:            1.0
  Plugin directory:          /etc/lynis/plugins
  ---------------------------------------------------
  Auditor:                   [Not Specified]
  Language:                  en
  Test category:             all
  Test group:                all
  ---------------------------------------------------
  - Program update status...                                  [ NO UPDATE ]

[+] System tools
------------------------------------
  - Scanning available tools...
  - Checking system binaries...

[+] Plugins (phase 1)
------------------------------------
 Note: plugins have more extensive tests and may take several minutes to complete

  - Plugin: debian
    [
[+] Debian Tests
------------------------------------

  [WARNING]: Test CORE-1000 had a long execution: 15.619200 seconds

  - Checking for system binaries that are required by Debian Tests...
    - Checking /bin...                                        [ FOUND ]
    - Checking /sbin...                                       [ FOUND ]
    - Checking /usr/bin...                                    [ FOUND ]
    - Checking /usr/sbin...                                   [ FOUND ]
    - Checking /usr/local/bin...                              [ FOUND ]
    - Checking /usr/local/sbin...                             [ FOUND ]
  - Authentication:
    - PAM (Pluggable Authentication Modules):
      - libpam-tmpdir                                         [ Not Installed ]
  - File System Checks:
    - DM-Crypt, Cryptsetup & Cryptmount:
  - Software:
    - apt-listbugs                                            [ Not Installed ]
    - apt-listchanges                                         [ Not Installed ]
    - needrestart                                             [ Not Installed ]
    - fail2ban                                                [ Not Installed ]
]

[+] Boot and services
------------------------------------
  - Service Manager                                           [ upstart ]
  - Checking UEFI boot                                        [ DISABLED ]
    - Boot loader                                             [ NONE FOUND ]
System has not been booted with systemd as init system (PID 1). Can't operate.
Failed to connect to bus: Host is down
  - Check running services (systemctl)                        [ DONE ]
        Result: found 0 running services
  - Check enabled services at boot (systemctl)                [ DONE ]
        Result: found 13 enabled services
  - Check startup files (permissions)                         [ OK ]
  - Running 'systemd-analyze security'
System has not been booted with systemd as init system (PID 1). Can't operate.
Failed to connect to bus: Host is down

[+] Kernel
------------------------------------
  - Checking default run level                                [ UNKNOWN ]
  - Checking CPU support (NX/PAE)
    CPU support: PAE and/or NoeXecute supported               [ FOUND ]
  - Checking kernel version and release                       [ DONE ]
  - Checking Linux kernel configuration file                  [ NOT FOUND ]
grep: /etc/kernel-img.conf: No such file or directory
  - Checking for available kernel update                      [ UNKNOWN ]
  - Checking core dumps configuration
    - configuration in etc/profile                            [ DEFAULT ]
    - 'hard' configuration in security/limits.conf            [ DEFAULT ]
    - 'soft' configuration in security/limits.conf            [ DEFAULT ]
    - Checking setuid core dumps configuration                [ PROTECTED ]
  - Check if reboot is needed                                 [ UNKNOWN ]

[+] Memory and Processes
------------------------------------
  - Checking /proc/meminfo                                    [ FOUND ]
  - Searching for dead/zombie processes                       [ NOT FOUND ]
  - Searching for IO waiting processes                        [ NOT FOUND ]
  - Search prelink tooling                                    [ NOT FOUND ]

[+] Users, Groups and Authentication
------------------------------------
  - Administrator accounts                                    [ OK ]
  - Unique UIDs                                               [ OK ]
  - Consistency of group files (grpck)                        [ OK ]
  - Unique group IDs                                          [ OK ]
  - Unique group names                                        [ OK ]
  - Password file consistency                                 [ OK ]
  - Password hashing methods                                  [ SUGGESTION ]
  - Checking password hashing rounds                          [ DISABLED ]
  - Query system users (non daemons)                          [ DONE ]
  - NIS+ authentication support                               [ NOT ENABLED ]
  - NIS authentication support                                [ NOT ENABLED ]
  - Sudoers file(s)                                           [ FOUND ]
    - Permissions for directory: /etc/sudoers.d               [ WARNING ]
    - Permissions for: /etc/sudoers                           [ OK ]
    - Permissions for: /etc/sudoers.d/README                  [ OK ]
  - PAM password strength tools                               [ SUGGESTION ]
  - PAM configuration files (pam.conf)                        [ FOUND ]
  - PAM configuration files (pam.d)                           [ FOUND ]
  - PAM modules                                               [ FOUND ]
  - LDAP module in PAM                                        [ NOT FOUND ]
  - Accounts without expire date                              [ SUGGESTION ]
  - Accounts without password                                 [ OK ]
  - Locked accounts                                           [ FOUND ]
  - Checking user password aging (minimum)                    [ DISABLED ]
  - User password aging (maximum)                             [ DISABLED ]
  - Checking expired passwords                                [ OK ]
  - Checking Linux single user mode authentication            [ OK ]
  - Determining default umask
    - umask (/etc/profile)                                    [ NOT FOUND ]
    - umask (/etc/login.defs)                                 [ SUGGESTION ]
  - LDAP authentication support                               [ NOT ENABLED ]
  - Logging failed login attempts                             [ ENABLED ]

[+] Shells
------------------------------------
  - Checking shells from /etc/shells
    Result: found 8 shells (valid shells: 8).
    - Session timeout settings/tools                          [ NONE ]
  - Checking default umask values
    - Checking default umask in /etc/bash.bashrc              [ NONE ]
    - Checking default umask in /etc/profile                  [ NONE ]

[+] File systems
------------------------------------
  - Checking mount points
    - Checking /home mount point                              [ SUGGESTION ]
    - Checking /tmp mount point                               [ SUGGESTION ]
    - Checking /var mount point                               [ SUGGESTION ]
  - Query swap partitions (fstab)                             [ NONE ]
  - Testing swap partitions                                   [ OK ]
  - Testing /proc mount (hidepid)                             [ SUGGESTION ]
  - Checking for old files in /tmp                            [ OK ]
  - Checking /tmp sticky bit                                  [ OK ]
  - Checking /var/tmp sticky bit                              [ OK ]
  - ACL support root file system                              [ ENABLED ]
  - Mount options of /dev                                     [ PARTIALLY HARDENED ]
  - Mount options of /dev/shm                                 [ HARDENED ]
  - Total without nodev:12 noexec:11 nosuid:7 ro or noexec (W^X): 8 of total 35

[+] USB Devices
------------------------------------
  - Checking usb-storage driver (modprobe config)             [ NOT DISABLED ]
  - Checking USB devices authorization                        [ DISABLED ]
  - Checking USBGuard                                         [ NOT FOUND ]

[+] Storage
------------------------------------
  - Checking firewire ohci driver (modprobe config)           [ NOT DISABLED ]

[+] NFS
------------------------------------
  - Check running NFS daemon                                  [ NOT FOUND ]

[+] Name services
------------------------------------
  - Checking search domains                                   [ FOUND ]
  - Searching DNS domain name                                 [ UNKNOWN ]

  [WARNING]: Test NAME-4028 had a long execution: 15.041102 seconds

  - Checking /etc/hosts
    - Duplicate entries in hosts file                         [ NONE ]
    - Presence of configured hostname in /etc/hosts           [ NOT FOUND ]
    - Hostname mapped to localhost                            [ NOT FOUND ]
    - Localhost mapping to IP address                         [ OK ]

[+] Ports and packages
------------------------------------
  - Searching package managers

  [WARNING]: Test NAME-4408 had a long execution: 10.086722 seconds

    - Searching dpkg package manager                          [ FOUND ]
      - Querying package manager
    - Query unpurged packages                                 [ FOUND ]
  - Checking security repository in sources.list file         [ OK ]
  - Checking APT package database                             [ OK ]
  - Checking vulnerable packages (apt-get only)               [ DONE ]

  [WARNING]: Test PKGS-7392 had a long execution: 15.992937 seconds

  - Checking upgradeable packages                             [ SKIPPED ]
  - Checking package audit tool                               [ INSTALLED ]
    Found: apt-get

=================================================================

  Exception found!

  Function/test:  [PKGS-7410]
  Message:        Could not find any kernel packages via package manager

  Help improving the Lynis community with your feedback!

  Steps:
  - Ensure you are running the latest version (/usr/sbin/lynis update check)
  - If so, create a GitHub issue at https://github.com/CISOfy/lynis
  - Include relevant parts of the log file or configuration file

  Thanks!

=================================================================

  - Toolkit for automatic upgrades                            [ NOT FOUND ]

[+] Networking
------------------------------------
  - Hostname (allowed characters)                             [ WARNING ]
  - Checking IPv6 configuration                               [ ENABLED ]
      Configuration method                                    [ AUTO ]
      IPv6 only                                               [ NO ]
  - Checking configured nameservers
    - Testing nameservers
      Nameserver: 8.8.8.8                                     [ SKIPPED ]
      Nameserver: 127.0.0.53                                  [ SKIPPED ]
    - DNSSEC supported (systemd-resolved)                     [ UNKNOWN ]
  - Checking default gateway                                  [ DONE ]
  - Getting listening ports (TCP/UDP)                         [ DONE ]
  - Checking promiscuous interfaces                           [ OK ]
  - Checking waiting connections                              [ OK ]
  - Checking status DHCP client
  - Checking for ARP monitoring software                      [ NOT FOUND ]
  - Uncommon network protocols                                [ 0 ]

[+] Printers and Spools
------------------------------------
  - Checking cups daemon                                      [ NOT FOUND ]
  - Checking lp daemon                                        [ NOT RUNNING ]

[+] Software: e-mail and messaging
------------------------------------

[+] Software: firewalls
------------------------------------
  - Checking iptables support                                 [ FOUND ]
    - Checking iptables policies of chains                    [ FOUND ]
# Warning: iptables-legacy tables present, use iptables-legacy to see them
iptables v1.8.7 (nf_tables): Could not fetch rule set generation id: Permission denied (you must be root)

    - Checking for empty ruleset                              [ WARNING ]
# Warning: iptables-legacy tables present, use iptables-legacy to see them
iptables v1.8.7 (nf_tables): Could not fetch rule set generation id: Permission denied (you must be root)

    - Checking for unused rules                               [ OK ]
iptables-save v1.8.7 (nf_tables): Could not fetch rule set generation id: Permission denied (you must be root)

  - Checking host based firewall                              [ ACTIVE ]

[+] Software: webserver
------------------------------------
  - Checking Apache                                           [ NOT FOUND ]
  - Checking nginx                                            [ NOT FOUND ]

[+] SSH Support
------------------------------------
  - Checking running SSH daemon                               [ NOT FOUND ]

[+] SNMP Support
------------------------------------
  - Checking running SNMP daemon                              [ NOT FOUND ]

[+] Databases
------------------------------------
    No database engines found

[+] LDAP Services
------------------------------------
  - Checking OpenLDAP instance                                [ NOT FOUND ]

[+] PHP
------------------------------------
  - Checking PHP                                              [ NOT FOUND ]

[+] Squid Support
------------------------------------
  - Checking running Squid daemon                             [ NOT FOUND ]

[+] Logging and files
------------------------------------
  - Checking for a running log daemon                         [ WARNING ]
    - Checking Syslog-NG status                               [ NOT FOUND ]
    - Checking systemd journal status                         [ NOT FOUND ]
    - Checking Metalog status                                 [ NOT FOUND ]
    - Checking RSyslog status                                 [ NOT FOUND ]
    - Checking RFC 3195 daemon status                         [ NOT FOUND ]
    - Checking klogd                                          [ NOT FOUND ]
    - Checking minilogd instances                             [ NOT FOUND ]
  - Checking logrotate presence                               [ OK ]
  - Checking log directories (static list)                    [ DONE ]
  - Checking open log files                                   [ SKIPPED ]

[+] Insecure services
------------------------------------
  - Installed inetd package                                   [ NOT FOUND ]
    - Checking enabled inetd services                         [ SUGGESTION ]
  - Installed xinetd package                                  [ OK ]
    - xinetd status
  - Installed rsh client package                              [ OK ]
  - Installed rsh server package                              [ SUGGESTION ]
  - Installed telnet client package                           [ FOUND ]
  - Installed telnet server package                           [ NOT FOUND ]
  - Checking NIS client installation                          [ OK ]
  - Checking NIS server installation                          [ OK ]
  - Checking TFTP client installation                         [ OK ]
  - Checking TFTP server installation                         [ OK ]

[+] Banners and identification
------------------------------------
  - /etc/issue                                                [ FOUND ]
    - /etc/issue contents                                     [ WEAK ]
  - /etc/issue.net                                            [ FOUND ]
    - /etc/issue.net contents                                 [ WEAK ]

[+] Scheduled tasks
------------------------------------
  - Checking crontab and cronjob files                        [ DONE ]

[+] Accounting
------------------------------------
  - Checking accounting information                           [ NOT FOUND ]
  - Checking sysstat accounting data                          [ NOT FOUND ]
  - Checking auditd                                           [ NOT FOUND ]

[+] Time and Synchronization
------------------------------------

[+] Cryptography
------------------------------------
  - Checking for expired SSL certificates [0/148]             [ NONE ]
  - Kernel entropy is sufficient                              [ YES ]
  - HW RNG & rngd                                             [ NO ]
  - SW prng                                                   [ NO ]
  - MOR variable not found                                    [ WEAK ]

[+] Virtualization
------------------------------------

[+] Containers
------------------------------------

[+] Security frameworks
------------------------------------
  - Checking presence AppArmor                                [ NOT FOUND ]
  - Checking presence SELinux                                 [ NOT FOUND ]
  - Checking presence TOMOYO Linux                            [ NOT FOUND ]
  - Checking presence grsecurity                              [ NOT FOUND ]
  - Checking for implemented MAC framework                    [ NONE ]

[+] Software: file integrity
------------------------------------
  - Checking file integrity tools
    - Tripwire                                                [ FOUND ]
  - Checking presence integrity tool                          [ FOUND ]

[+] Software: System tooling
------------------------------------
  - Checking automation tooling
  - Automation tooling                                        [ NOT FOUND ]
  - Checking for IDS/IPS tooling                              [ NONE ]

[+] Software: Malware
------------------------------------
  - Malware software components                               [ NOT FOUND ]

[+] File Permissions
------------------------------------
  - Starting file permissions check
    File: /etc/crontab                                        [ SUGGESTION ]
    File: /etc/group                                          [ OK ]
    File: /etc/group-                                         [ OK ]
    File: /etc/hosts.allow                                    [ OK ]
    File: /etc/hosts.deny                                     [ OK ]
    File: /etc/issue                                          [ OK ]
    File: /etc/issue.net                                      [ OK ]
    File: /etc/passwd                                         [ OK ]
    File: /etc/passwd-                                        [ OK ]
    File: /etc/ssh/sshd_config                                [ SUGGESTION ]
    File: /etc/hosts.equiv                                    [ OK ]
    Directory: /etc/cron.d                                    [ SUGGESTION ]
    Directory: /etc/cron.daily                                [ SUGGESTION ]
    Directory: /etc/cron.hourly                               [ SUGGESTION ]
    Directory: /etc/cron.weekly                               [ SUGGESTION ]
    Directory: /etc/cron.monthly                              [ SUGGESTION ]

[+] Home directories
------------------------------------
  - Permissions of home directories                           [ OK ]
  - Ownership of home directories                             [ OK ]
  - Checking shell history files                              [ OK ]

[+] Kernel Hardening
------------------------------------
  - Comparing sysctl key pairs with scan profile
    - dev.tty.ldisc_autoload (exp: 0)                         [ DIFFERENT ]
    - fs.protected_fifos (exp: 2)                             [ DIFFERENT ]
    - fs.protected_hardlinks (exp: 1)                         [ OK ]
    - fs.protected_regular (exp: 2)                           [ OK ]
    - fs.protected_symlinks (exp: 1)                          [ OK ]
    - fs.suid_dumpable (exp: 0)                               [ DIFFERENT ]
    - kernel.core_uses_pid (exp: 1)                           [ DIFFERENT ]
    - kernel.ctrl-alt-del (exp: 0)                            [ OK ]
    - kernel.dmesg_restrict (exp: 1)                          [ OK ]
    - kernel.kptr_restrict (exp: 2)                           [ DIFFERENT ]
    - kernel.modules_disabled (exp: 1)                        [ DIFFERENT ]
    - kernel.perf_event_paranoid (exp: 3)                     [ DIFFERENT ]
    - kernel.randomize_va_space (exp: 2)                      [ OK ]
    - kernel.sysrq (exp: 0)                                   [ DIFFERENT ]
    - kernel.unprivileged_bpf_disabled (exp: 1)               [ DIFFERENT ]
    - kernel.yama.ptrace_scope (exp: 1 2 3)                   [ OK ]
    - net.ipv4.conf.all.accept_redirects (exp: 0)             [ OK ]
    - net.ipv4.conf.all.accept_source_route (exp: 0)          [ OK ]
    - net.ipv4.conf.all.bootp_relay (exp: 0)                  [ OK ]
    - net.ipv4.conf.all.forwarding (exp: 0)                   [ DIFFERENT ]
    - net.ipv4.conf.all.log_martians (exp: 1)                 [ DIFFERENT ]
    - net.ipv4.conf.all.mc_forwarding (exp: 0)                [ OK ]
    - net.ipv4.conf.all.proxy_arp (exp: 0)                    [ OK ]
    - net.ipv4.conf.all.rp_filter (exp: 1)                    [ DIFFERENT ]
    - net.ipv4.conf.all.send_redirects (exp: 0)               [ DIFFERENT ]
    - net.ipv4.conf.default.accept_redirects (exp: 0)         [ OK ]
    - net.ipv4.conf.default.accept_source_route (exp: 0)      [ DIFFERENT ]
    - net.ipv4.conf.default.log_martians (exp: 1)             [ DIFFERENT ]
    - net.ipv4.icmp_echo_ignore_broadcasts (exp: 1)           [ OK ]
    - net.ipv4.icmp_ignore_bogus_error_responses (exp: 1)     [ OK ]
    - net.ipv4.tcp_syncookies (exp: 1)                        [ OK ]
    - net.ipv4.tcp_timestamps (exp: 0 1)                      [ OK ]
    - net.ipv6.conf.all.accept_redirects (exp: 0)             [ OK ]
    - net.ipv6.conf.all.accept_source_route (exp: 0)          [ OK ]
    - net.ipv6.conf.default.accept_redirects (exp: 0)         [ OK ]
    - net.ipv6.conf.default.accept_source_route (exp: 0)      [ OK ]

[+] Hardening
------------------------------------
    - Installed compiler(s)                                   [ NOT FOUND ]
    - Installed malware scanner                               [ NOT FOUND ]
    - Non-native binary formats                               [ NOT FOUND ]

[+] Custom tests
------------------------------------
  - Running custom tests...                                   [ NONE ]

[+] Plugins (phase 2)
------------------------------------

================================================================================

  -[ Lynis 3.0.7 Results ]-

  Warnings (3):
  ----------------------------
  ! Hostname contains invalid characters [NETW-2400]
    - Details  : hostname
    - Solution : See log file for invalid characters
      https://cisofy.com/lynis/controls/NETW-2400/

  ! iptables module(s) loaded, but no rules active [FIRE-4512]
      https://cisofy.com/lynis/controls/FIRE-4512/

  ! klogd is not running, which could lead to missing kernel messages in log files [LOGG-2138]
      https://cisofy.com/lynis/controls/LOGG-2138/

  Suggestions (46):
  ----------------------------
  * This release is more than 4 months old. Check the website or GitHub to see if there is an update available. [LYNIS]
      https://cisofy.com/lynis/controls/LYNIS/

  * Install libpam-tmpdir to set $TMP and $TMPDIR for PAM sessions [DEB-0280]
      https://cisofy.com/lynis/controls/DEB-0280/

  * Install apt-listbugs to display a list of critical bugs prior to each APT installation. [DEB-0810]
      https://cisofy.com/lynis/controls/DEB-0810/

  * Install apt-listchanges to display any significant changes prior to any upgrade via APT. [DEB-0811]
      https://cisofy.com/lynis/controls/DEB-0811/

  * Install needrestart, alternatively to debian-goodies, so that you can run needrestart after upgrades to determine which daemons are using old versions of libraries and need restarting. [DEB-0831]
      https://cisofy.com/lynis/controls/DEB-0831/

  * Install fail2ban to automatically ban hosts that commit multiple authentication errors. [DEB-0880]
      https://cisofy.com/lynis/controls/DEB-0880/

  * Determine runlevel and services at startup [BOOT-5180]
      https://cisofy.com/lynis/controls/BOOT-5180/

  * Consider hardening system services [BOOT-5264]
    - Details  : Run '/usr/bin/systemd-analyze security SERVICE' for each service
      https://cisofy.com/lynis/controls/BOOT-5264/

  * Determine why /vmlinuz or /boot/vmlinuz is missing on this Debian/Ubuntu system. [KRNL-5788]
    - Details  : /vmlinuz or /boot/vmlinuz
      https://cisofy.com/lynis/controls/KRNL-5788/

  * If not required, consider explicit disabling of core dump in /etc/security/limits.conf file [KRNL-5820]
      https://cisofy.com/lynis/controls/KRNL-5820/

  * Check PAM configuration, add rounds if applicable and expire passwords to encrypt with new values [AUTH-9229]
      https://cisofy.com/lynis/controls/AUTH-9229/

  * Configure password hashing rounds in /etc/login.defs [AUTH-9230]
      https://cisofy.com/lynis/controls/AUTH-9230/

  * Install a PAM module for password strength testing like pam_cracklib or pam_passwdqc [AUTH-9262]
      https://cisofy.com/lynis/controls/AUTH-9262/

  * When possible set expire dates for all password protected accounts [AUTH-9282]
      https://cisofy.com/lynis/controls/AUTH-9282/

  * Look at the locked accounts and consider removing them [AUTH-9284]
      https://cisofy.com/lynis/controls/AUTH-9284/

  * Configure minimum password age in /etc/login.defs [AUTH-9286]
      https://cisofy.com/lynis/controls/AUTH-9286/

  * Configure maximum password age in /etc/login.defs [AUTH-9286]
      https://cisofy.com/lynis/controls/AUTH-9286/

  * Default umask in /etc/login.defs could be more strict like 027 [AUTH-9328]
      https://cisofy.com/lynis/controls/AUTH-9328/

  * To decrease the impact of a full /home file system, place /home on a separate partition [FILE-6310]
      https://cisofy.com/lynis/controls/FILE-6310/

  * To decrease the impact of a full /tmp file system, place /tmp on a separate partition [FILE-6310]
      https://cisofy.com/lynis/controls/FILE-6310/

  * To decrease the impact of a full /var file system, place /var on a separate partition [FILE-6310]
      https://cisofy.com/lynis/controls/FILE-6310/

  * Disable drivers like USB storage when not used, to prevent unauthorized storage or data theft [USB-1000]
      https://cisofy.com/lynis/controls/USB-1000/

  * Disable drivers like firewire storage when not used, to prevent unauthorized storage or data theft [STRG-1846]
      https://cisofy.com/lynis/controls/STRG-1846/

  * Check DNS configuration for the dns domain name [NAME-4028]
      https://cisofy.com/lynis/controls/NAME-4028/

  * Add the IP name and FQDN to /etc/hosts for proper name resolving [NAME-4404]
      https://cisofy.com/lynis/controls/NAME-4404/

  * Purge old/removed packages (6 found) with aptitude purge or dpkg --purge command. This will cleanup old configuration files, cron jobs and startup scripts. [PKGS-7346]
      https://cisofy.com/lynis/controls/PKGS-7346/

  * Install debsums utility for the verification of packages with known good database. [PKGS-7370]
      https://cisofy.com/lynis/controls/PKGS-7370/

  * Install package apt-show-versions for patch management purposes [PKGS-7394]
      https://cisofy.com/lynis/controls/PKGS-7394/

  * Consider using a tool to automatically apply upgrades [PKGS-7420]
      https://cisofy.com/lynis/controls/PKGS-7420/

  * Determine if protocol 'dccp' is really needed on this system [NETW-3200]
      https://cisofy.com/lynis/controls/NETW-3200/

  * Determine if protocol 'sctp' is really needed on this system [NETW-3200]
      https://cisofy.com/lynis/controls/NETW-3200/

  * Determine if protocol 'rds' is really needed on this system [NETW-3200]
      https://cisofy.com/lynis/controls/NETW-3200/

  * Determine if protocol 'tipc' is really needed on this system [NETW-3200]
      https://cisofy.com/lynis/controls/NETW-3200/

  * Disable the 'VRFY' command [MAIL-8820:disable_vrfy_command]
    - Details  : disable_vrfy_command=no
    - Solution : run postconf -e disable_vrfy_command=yes to change the value
      https://cisofy.com/lynis/controls/MAIL-8820/

  * Check if any syslog daemon is running and correctly configured. [LOGG-2130]
      https://cisofy.com/lynis/controls/LOGG-2130/

  * Although inetd is not running, make sure no services are enabled in /etc/inetd.conf, or remove inetd service [INSE-8006]
      https://cisofy.com/lynis/controls/INSE-8006/

  * Remove the rsh-server package and replace with a more secure alternative like SSH [INSE-8304]
      https://cisofy.com/lynis/controls/INSE-8304/

  * Add a legal banner to /etc/issue, to warn unauthorized users [BANN-7126]
      https://cisofy.com/lynis/controls/BANN-7126/

  * Add legal banner to /etc/issue.net, to warn unauthorized users [BANN-7130]
      https://cisofy.com/lynis/controls/BANN-7130/

  * Enable process accounting [ACCT-9622]
      https://cisofy.com/lynis/controls/ACCT-9622/

  * Enable sysstat to collect accounting (no results) [ACCT-9626]
      https://cisofy.com/lynis/controls/ACCT-9626/

  * Enable auditd to collect audit information [ACCT-9628]
      https://cisofy.com/lynis/controls/ACCT-9628/

  * Determine if automation tools are present for system management [TOOL-5002]
      https://cisofy.com/lynis/controls/TOOL-5002/

  * Consider restricting file permissions [FILE-7524]
    - Details  : See screen output or log file
    - Solution : Use chmod to change file permissions
      https://cisofy.com/lynis/controls/FILE-7524/

  * One or more sysctl values differ from the scan profile and could be tweaked [KRNL-6000]
    - Solution : Change sysctl value or disable test (skip-test=KRNL-6000:<sysctl-key>)
      https://cisofy.com/lynis/controls/KRNL-6000/

  * Harden the system by installing at least one malware scanner, to perform periodic file system scans [HRDN-7230]
    - Solution : Install a tool like rkhunter, chkrootkit, OSSEC
      https://cisofy.com/lynis/controls/HRDN-7230/

  Follow-up:
  ----------------------------
  - Show details of a test (lynis show details TEST-ID)
  - Check the logfile for all details (less /var/log/lynis.log)
  - Read security controls texts (https://cisofy.com)
  - Use --upload to upload data to central system (Lynis Enterprise users)

================================================================================

  Lynis security scan details:

  Hardening index : 62 [############        ]
  Tests performed : 238
  Plugins enabled : 1

  Components:
  - Firewall               [V]
  - Malware scanner        [X]

  Scan mode:
  Normal [V]  Forensics [ ]  Integration [ ]  Pentest [ ]

  Lynis modules:
  - Compliance status      [?]
  - Security audit         [V]
  - Vulnerability scan     [V]

  Files:
  - Test and debug information      : /var/log/lynis.log
  - Report data                     : /var/log/lynis-report.dat

================================================================================

  Exceptions found
  Some exceptional events or information was found!

  What to do:
  You can help by providing your log file (/var/log/lynis.log).
  Go to https://cisofy.com/contact/ and send your file to the e-mail address listed

================================================================================

  Lynis 3.0.7

  Auditing, system hardening, and compliance for UNIX-based systems
  (Linux, macOS, BSD, and others)

  2007-2021, CISOfy - https://cisofy.com/lynis/
  Enterprise support available (compliance, plugins, interface and tools)

```

</details>

Summary

Critical Fixes
  - Configure iptables/ufw for firewall security
  - Start kernel logging (rsyslog)
  - Fix hostname format (`Baker_Street_Linux_Server` contains invalid characters, `"_" is not allowed in hostnames`)

High Priority Fixes
  - Install libpam-cracklib for password security
  - Enable automatic security updates
  - Set password expiration policies
  - Install audit logging (auditd)

Additional Hardening
  - Remove insecure services (rsh-server, telnet)
  - Verify SSH settings
  - Purge unused packages

By proactively managing updates and monitoring security advisories, you can significantly reduce the risk of potential exploits on your system.

<br><br><br><br>






































